<!DOCTYPE html>




<html class="theme-next muse" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#fff">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1815293530059355"
     crossorigin="anonymous"></script>








<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="3uDNOuCQu6inuHg_QHas_nknR5rEe5WHetNJ6bVEwVA" />



  <meta name="msvalidate.01" content="DCCE27951FD510E830BDD5D014EB15B4" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/uploads/favicon-32x32.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/uploads/favicon-16x16.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#fff">





  <meta name="keywords" content="C语言, 指针, 函数指针, 指针函数, 变量, 常量, 宏定义, static, 静态局部变量, 预处理, 自增, 自减, 系统函数库, 类型转换, 数组, 指针数组, 数组指针, 结构体, 共用体, 联合体, 文件读写, 回调函数, 动态内存分配, malloc, free" />










<meta name="description" content="C 语言中的细节知识点">
<meta property="og:type" content="article">
<meta property="og:title" content="C 语言中的细节知识点">
<meta property="og:url" content="https://woodwhales.cn/2019/11/18/053/index.html">
<meta property="og:site_name" content="woodwhale&#39;s blog">
<meta property="og:description" content="C 语言中的细节知识点">
<meta property="og:locale">
<meta property="og:image" content="https://image.woodwhales.cn/053/face.png">
<meta property="article:published_time" content="2019-11-17T17:23:00.000Z">
<meta property="article:modified_time" content="2025-04-06T14:52:05.207Z">
<meta property="article:author" content="木鲸鱼">
<meta property="article:tag" content="C 语言">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://image.woodwhales.cn/053/face.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"hide","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://woodwhales.cn/2019/11/18/053/"/>




<script async src="https://fundingchoicesmessages.google.com/i/pub-1815293530059355?ers=1" nonce="iiDO3i5ZgRmrRRl65XssBQ"></script><script nonce="iiDO3i5ZgRmrRRl65XssBQ">(function() {function signalGooglefcPresent() {if (!window.frames['googlefcPresent']) {if (document.body) {const iframe = document.createElement('iframe'); iframe.style = 'width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;'; iframe.style.display = 'none'; iframe.name = 'googlefcPresent'; document.body.appendChild(iframe);} else {setTimeout(signalGooglefcPresent, 0);}}}signalGooglefcPresent();})();</script>

  <title>C 语言中的细节知识点 | woodwhale's blog</title>
  








<meta name="generator" content="Hexo 7.0.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

	<div class="bg_content">
		<canvas id="canvas"></canvas>
	</div>

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">woodwhale's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">技术改变生活</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tools">
          <a href="/tools/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-cogs"></i> <br />
            
            工具
          </a>
        </li>
      
        
        <li class="menu-item menu-item-resources">
          <a href="/resources/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-gift"></i> <br />
            
            福利
          </a>
        </li>
      
        
        <li class="menu-item menu-item-setup">
          <a href="/setup/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-power-off"></i> <br />
            
            装机
          </a>
        </li>
      
        
        <li class="menu-item menu-item-works">
          <a href="/works/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-bars"></i> <br />
            
            作品
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-futbol-o"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://woodwhales.cn/2019/11/18/053/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="woodwhales">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar-woodwhale.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="woodwhale's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">C 语言中的细节知识点</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-11-18T01:23:00+08:00">
                2019-11-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C-%E8%AF%AD%E8%A8%80/" itemprop="url" rel="index">
                    <span itemprop="name">C 语言</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/11/18/053/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/11/18/053/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-pencil-square-o"></i>
                </span>
                
                  <span class="post-meta-item-text">全文总计&#58;</span>
                
                <span title="全文总计">
                   字
                </span>
              

              

              
            </div>
          

          
              <div class="post-description">
                  C 语言中的细节知识点
              </div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      
        <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
          
          
            <div class="post-gallery-row">
              <a class="post-gallery-img fancybox"
                 target="_blank" href="https://image.woodwhales.cn/053/face.png" rel="gallery_cmb21nrik004om8v88kte6m1o noopener"
                 itemscope itemtype="http://schema.org/ImageObject" itemprop="url">
                <img src="https://image.woodwhales.cn/053/face.png" itemprop="contentUrl"/>
              </a>
            
          

          
          </div>
        </div>
      

      
	    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1815293530059355"
     crossorigin="anonymous"></script>
        <h2 id="常量的定义"><a href="#常量的定义" class="headerlink" title="常量的定义"></a>常量的定义</h2><p>常量的定义可以有两种方式</p>
<h3 id="const"><a href="#const" class="headerlink" title="const"></a>const</h3><p>格式：<code>const 数据类型 常量名 = 常量值</code></p>
<p>示例：<code>const double PI = 3.14</code></p>
<h3 id="define"><a href="#define" class="headerlink" title="#define"></a>#define</h3><p>格式：<code>#define 常量名 常量值</code></p>
<p>示例：<code>#define SUM = 1 + 2</code></p>
<h3 id="const-和-define-的区别"><a href="#const-和-define-的区别" class="headerlink" title="const 和 #define 的区别"></a>const 和 #define 的区别</h3><ul>
<li>const 定义的常量时带类型，#define 不带类型</li>
<li>const 是在 编译、运行的时候起作用，而 #define 是在编译的预处理阶段起作用</li>
<li>#define 只是简单的替换，没有类型检查。简单的字符串替换会导致<strong>边界效应</strong></li>
<li>const 常量可以进行调试的，#define 是不能进行调试的，主要是预编译阶段就已经替换掉了，调试的时候就没它了</li>
<li>const 不能重定义，不可以定义两个一样的，而 #define 通过 #undef 取消某个符号的定义，再重新定义</li>
<li>define 可以配合<code>#ifdef</code>、 <code>#ifndef</code>、 <code>#endif</code>来使用， 可以让代码更加灵活，比如我们可以通过 #define 来启动或者关闭调试信息。</li>
</ul>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> SUM_CONST = <span class="number">1</span> + <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SUM_DEFINE 1 + 2;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">int</span> num1 = <span class="number">1</span> / SUM_CONST;  <span class="comment">// 表示 1 / 3</span></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> num2 = <span class="number">1</span> / SUM_DEFINE; <span class="comment">// 预编译之后，源码中的表达式是：1 / 1 + 2，而不是 1 / (+ 2)</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"num1 = %d\n"</span>, num1); <span class="comment">// 输出结果：0</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"num2 = %d\n"</span>, num2); <span class="comment">// 输出结果：3</span></span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/01.png"></p>
<p>从上述的输出结果，可以看出<code>#define</code>仅仅是预编译之后将常量替换成原来的表达式。</p>
<h2 id="取模运算符"><a href="#取模运算符" class="headerlink" title="取模运算符"></a>取模运算符</h2><p>除法运算符的底层原理：</p>
<p><code>A % B</code>在编译器中会自动翻译为：<code>A - ((A) / (B)) * (B)</code>。</p>
<p>示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * A % B = A - A / B * B</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">int</span> num1 = <span class="number">-1</span> % <span class="number">2</span>; <span class="comment">// 表示：-1 - (-1) / 2 * 2 = -1 - (0 * 2) = -1 - 0 = -1</span></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> num2 = <span class="number">-3</span> % <span class="number">1</span>; <span class="comment">// 表示：-3 - (-3) / 1 * 1 = -3 - (-3 * 1) = -3 + 3 = 0</span></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> num3 = <span class="number">-3</span> % <span class="number">2</span>; <span class="comment">// 表示：-3 - (-3) / 2 * 2 = -3 - (-1 * 2) = -3 - (-2) = -1</span></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> num4 = <span class="number">-3</span> % <span class="number">3</span>; <span class="comment">// 表示：-3 - (-3) / 3 * 3 = -3 - (-1 * 3) = -3 + 3 = 0</span></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> num5 = <span class="number">-3</span> % <span class="number">4</span>; <span class="comment">// 表示：-3 - (-3) / 4 * 4 = -3 - (0 * 4) = -3 + 0 = -3</span></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"num1 = %d\n"</span>, num1);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"num2 = %d\n"</span>, num2);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"num3 = %d\n"</span>, num3);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"num4 = %d\n"</span>, num4);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"num5 = %d\n"</span>, num5);</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/02.png"></p>
<p>从取模的底层原理可以得出结论：取模数不可以为零，形如：<code>2 % 0</code>这样的表达式是非法的。</p>
<h2 id="算术运算中的自动类型转换"><a href="#算术运算中的自动类型转换" class="headerlink" title="算术运算中的自动类型转换"></a>算术运算中的自动类型转换</h2><p>在基本运算过程中，一定要注意 C 语言中不带小数点的数字默认类型是 int 类型，带小数点的数字默认类型是 double 类型，在计算中可能会存在类型自动转换问题，如下面的代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 运算中的自动类型转换</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">double</span> num1 = <span class="number">5</span> / <span class="number">2</span>; <span class="comment">// num 不是 2.500000，而是 2.000000，因为左边是先int类型除法计算，再类型自动转换</span></span><br><span class="line"></span><br><span class="line">	<span class="type">double</span> num2 = <span class="number">5.0</span> / <span class="number">2</span>; <span class="comment">// num 是 2.500000，因为左边是先都double类型除法计算，再赋值。</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"num1 = %f\n"</span>, num1);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"num2 = %f\n"</span>, num2);</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/03.png"></p>
<h2 id="自增-自减运算"><a href="#自增-自减运算" class="headerlink" title="自增/自减运算"></a>自增/自减运算</h2><p>如果变量仅仅是自己自增或者自减操作，那么仅仅影响变量本身。</p>
<p>如果自增或自减并赋值给另外一个变量，那么会有赋值顺序。</p>
<p>示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自增/自减运算</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">int</span> i = <span class="number">10</span>, j = <span class="number">10</span>;</span><br><span class="line">	<span class="type">int</span> k = <span class="number">10</span>, q = <span class="number">10</span>;</span><br><span class="line">	<span class="type">int</span> m = i++;</span><br><span class="line">	<span class="type">int</span> n = ++j;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"i = %d\n"</span>, i);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"j = %d\n"</span>, j);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"m = %d\n"</span>, m); <span class="comment">// 等价于先赋值再自增，m = j ,j = j + 1</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"n = %d\n"</span>, n); <span class="comment">// 等价于先自增再赋值，j = j + 1, m = j</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"k = %d\n"</span>, k);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"q = %d\n"</span>, q);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(k++ == <span class="number">10</span>) { <span class="comment">// 等价于先比较再自增</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"k++ == 10\n"</span>);</span><br><span class="line">	} <span class="keyword">else</span> {</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"k++ != 10\n"</span>);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(++q == <span class="number">10</span>) { <span class="comment">// 等价于先自增再比较</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"++q == 10\n"</span>);</span><br><span class="line">	} <span class="keyword">else</span> {</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"++q != 10\n"</span>);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/04.png"></p>
<h2 id="变量和指针"><a href="#变量和指针" class="headerlink" title="变量和指针"></a>变量和指针</h2><p>指针是 C 语言的灵魂，指针就是地址，地址就是指针：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 变量和指针</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">int</span> num = <span class="number">10</span>;</span><br><span class="line">	<span class="type">int</span> * ptr = &amp;num;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"num 变量本身的值：%d\n"</span>, num);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"num 变量本身的值所在的内存地址：%p\n"</span>, &amp;num);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"ptr 变量本身的值：%p\n"</span>, ptr);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"ptr 变量本身的值所在的内存地址：%p\n"</span>, &amp;ptr);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"ptr 变量本身的值所在的内存地址中的内容：%d\n"</span>, *ptr);</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/05.png"></p>
<p>上述的执行结果，可能存在不一样，但是<code>num 变量本身的值所在的内存地址</code>和<code>ptr 变量本身的值</code>两者一定是相等的。</p>
<p>上述执行结果解释：</p>
<p>在源码被编译之后，所有的变量都会变成了汇编指令中的开辟一块内存空间的意思，而这个赋值操作就是对这块开辟的内存空间进行设置值。</p>
<p>好比一位客人要进入酒店入住：</p>
<ul>
<li><p>这位客人要告诉前台，我要住什么类型的房间，是单人间还是双人间，这里的房间类型就是变量的类型，也就是<code>int</code>类型。</p>
</li>
<li><p>这位客人还要告诉前台，你选择的这个房间要住具体的人是谁，这里的具体的人就是变量被赋值的值，也就是数字<code>10</code>。</p>
</li>
</ul>
<p><em>以上过程中前台还需要考虑一下这位客人要求开的房间类型和要住的人是不是匹配，也就是变量申明的类型和赋值的值类型是否匹配</em></p>
<p>经过以上过程之后，这位客人就可以办理入住手续并顺利入住了。</p>
<p>注意的是客人说你们的房间号都是一大串数字记忆起来太麻烦了，我出门之后很容易忘记我的房间号，能不能我给我这个房间号起一个别名。于是前台说，那你自己起一个自己能记住的房间号别名吧，我帮你做好映射关系。于是这位客人给自己的房间号起了个别名叫<code>num</code>，也就是变量的名字。</p>
<p>当这个人被入住进入这个房间之后，酒店老板了来问前台，刚才开的房间里住着是谁啊，前台想那么多的房间号都是数字，我要是顺着数字找我也费劲，刚才的客人不是给自己起了个房间号别名叫<code>num</code>么，我也做好了映射，直接<code>&amp;num</code>就能知道这个人的房间号是多少，并且这个别名就是这个人起的，所以这个别名就代表了这个房间里住的人。也是前台很爽快的回复老板，这个人是<code>num</code>，他住的房间号是<code>&amp;num</code>。</p>
<p>这时老板再问，人既然住在了这个房间里，那么这个房间号你是记在哪里了呢，总不会用脑袋记忆吧，并且这个人所住的房间类型，我也不知道啊。聪明的前台说，这个已经记住了，就是在客人起房间号别名的时候就做好了映射记录了。我专门设置了一个专门用来存房间号的房间，叫<code>ptr</code>，这特殊的房间里面不住客人，只把某位客人所住的房间号码放在这个房间里，光记住这个客人的房间号不够，这个特殊的房间还是特殊的类型，叫客人房间号的类型，也就是<code>int *</code>。</p>
<p>前台很爽快的回复老板，这个<code>ptr</code>房间里存的某位客人的房间号就是：<code>ptr</code>，这位客人就是：<code>* ptr</code>。</p>
<p>从上述比喻可以看出，<code>ptr</code>房间里的东西存的就是客人的房间号码，只要谁拿到了这个客人的房间号码，那么就可以对这位客人为所欲为了。</p>
<p><em>如果某个杀手知道了这个房间号码，带把枪把这个房间号码里住的人给枪杀了，那么是个危险的事情。当然如果某个医生知道这个房间号码，就能在第一时间及时抢救这位客人。</em></p>
<h2 id="变量的作用域"><a href="#变量的作用域" class="headerlink" title="变量的作用域"></a>变量的作用域</h2><p>局部变量，系统不会对其默认初始化，必须对局部变量初始化之后才能使用，否则程序运行可能会异常退出。</p>
<p>全局变量，系统会自动对其初始化，如下所示：</p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>初始化默认值</th>
</tr>
</thead>
<tbody><tr>
<td>int</td>
<td>0</td>
</tr>
<tr>
<td>char</td>
<td>‘\0’</td>
</tr>
<tr>
<td>float</td>
<td>0.0</td>
</tr>
<tr>
<td>double</td>
<td>0.0</td>
</tr>
<tr>
<td>pointer 指针</td>
<td>NULL</td>
</tr>
</tbody></table>
<p>正确地初始化变量是一个良好的编程习惯。否则有时程序可能产生意想不到的结果，因为未初始化的变量会保存一些内存位置中已经可用的垃圾值。</p>
<h2 id="static-关键字"><a href="#static-关键字" class="headerlink" title="static 关键字"></a>static 关键字</h2><p><code>static</code>关键字在 C 语言中比较常用，使用恰当能够大大提高程序的模块化特性，有利于扩展和维护。</p>
<h3 id="局部变量使用-static"><a href="#局部变量使用-static" class="headerlink" title="局部变量使用 static"></a>局部变量使用 static</h3><p>局部变量被 static 修饰后，我们称为静态局部变量</p>
<p>对应静态局部变量在声明时未赋初值，编译器也会把它初始化为默认值。</p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>初始化默认值</th>
</tr>
</thead>
<tbody><tr>
<td>int</td>
<td>0</td>
</tr>
<tr>
<td>char</td>
<td>‘\0’</td>
</tr>
<tr>
<td>float</td>
<td>0.0</td>
</tr>
<tr>
<td>double</td>
<td>0.0</td>
</tr>
<tr>
<td>pointer 指针</td>
<td>NULL</td>
</tr>
</tbody></table>
<p>静态局部变量存储于进程的<strong>静态存储区（全局性质）</strong>， <strong>只会被初始化一次</strong>，即使函数返回，它的值也会保持不变</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 静态局部变量</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">fun_static</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">static</span> <span class="type">int</span> n = <span class="number">10</span>; <span class="comment">// static 修饰的局部变量会存在静态存储区（全局性的区域），只会初始化一次</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"n = %d\n"</span>, n);</span><br><span class="line">	</span><br><span class="line">	n++;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"n = %d\n"</span>, n);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	fun_static();</span><br><span class="line"></span><br><span class="line">	fun_static();</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/06.png"></p>
<h3 id="全局变量使用-static"><a href="#全局变量使用-static" class="headerlink" title="全局变量使用 static"></a>全局变量使用 static</h3><p>普通全局变量对整个工程可见，其他文件可以使用<code>extern</code>外部声明后直接使用。也就是说其他文件不能再定义一个与其相同名字的变量了（否则编译器会认为它们是同一个变量），静态全局变量仅对当前文件可见，其他文件不可访问，其他文件可以定义与其同名的变量，两者互不影响。</p>
<p>定义不需要与其他文件共享的全局变量时，加上<code>static</code>关键字能够有效地降低程序模块之间的耦合，避免不同文件同名变量的冲突，且不会误使用。</p>
<p>代码示例：</p>
<p>file01.c 文件中定义全局变量：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> num1 = <span class="number">10</span>; <span class="comment">// 普通全局变量</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> num2 = <span class="number">20</span>; <span class="comment">// 静态全局变量，只能在本文件中使用，而不能在其他文件中使用</span></span><br></pre></td></tr></tbody></table></figure>

<p>file02.c 文件中引入普通全局变量：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="type">int</span> num1; <span class="comment">// 引用外部文件中的普通全局变量，千万不要对其赋值！</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">int</span> num2; </span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"num1 = %d\n"</span>, num1);</span><br><span class="line">	<span class="comment">// printf("num2 = %d\n", num2); // num2 在外部文件中已经是静态全局变量了，</span></span><br><span class="line">								    <span class="comment">// 那么本文件只是引用而不重新初始化，那么运行会报错</span></span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/07.png"></p>
<p>代码示例：</p>
<p>file01.c 文件中定义全局变量：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> num1 = <span class="number">10</span>; <span class="comment">// 普通全局变量</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> num2 = <span class="number">20</span>; <span class="comment">// 静态全局变量，只能在本文件中使用，而不能在其他文件中使用</span></span><br></pre></td></tr></tbody></table></figure>

<p>file02.c 文件中引入普通全局变量：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="type">int</span> num1; <span class="comment">// 引用外部文件中的普通全局变量，千万不要对其赋值！</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">int</span> num2; </span><br><span class="line"></span><br><span class="line"><span class="comment">// int num1 = 9; // 这里的num1全局变量在其他文件中已经定义并被本文件引用，</span></span><br><span class="line">                 <span class="comment">// 因此不允许定义相同名的全局变量</span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> num2 = <span class="number">11</span>; <span class="comment">// 由于 外部文件中的num2被定义成了静态全局变量，</span></span><br><span class="line">					  <span class="comment">// 那么本文件可以定义相同变量名的普通全局变量或静态全局变量</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"num1 = %d\n"</span>, num1);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"num2 = %d\n"</span>, num2);</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/08.png"></p>
<p>从第二个示例可以看出，一般在文件中定义全局变量的时候，如果不想其他文件使用，那么就使用<code>static</code>修饰，其他文件引用了也没关系，因为它们要想使用这个变量，就得自己重新定义一个相同名字的全局变量。从而使得自己的全局变量”很安全”。</p>
<h3 id="函数使用-static"><a href="#函数使用-static" class="headerlink" title="函数使用 static"></a>函数使用 static</h3><p>函数的使用方式与全局变量类似，在函数的返回类型前加上static，就是静态函数。</p>
<p>非静态函数可以在另一个文件中通过<code>extern</code>引用。</p>
<p>静态函数只能在声明它的文件中可见，其他文件不能引用该函数。</p>
<p>不同的文件可以使用相同名字的静态函数，互不影响。</p>
<p>代码示例：</p>
<p>file03.c 文件中定义函数</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 普通函数（非静态函数）</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">fun1</span><span class="params">(<span class="type">void</span>)</span> {</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"fun1 was executed...\n"</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// static 修饰的函数叫静态函数</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">fun2</span><span class="params">(<span class="type">void</span>)</span> {</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"fun2 was executed...\n"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>file04.c 文件中使用外部文件中的函数：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">fun1</span><span class="params">(<span class="type">void</span>)</span>; <span class="comment">// 使用 extern 引入外部文件中的非静态函数</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">fun2</span><span class="params">(<span class="type">void</span>)</span>; <span class="comment">// 可以引入外部文件中的静态函数，但是不能使用！</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	fun1();</span><br><span class="line">	<span class="comment">// fun2(); // 不能正常使用外部文件中的静态函数</span></span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/09.png"></p>
<p>和静态全局变量一样，本文件中引入了外部文件中的静态函数，如果想使用相同名称的函数名，那么需要自己重新定义：</p>
<p>file03.c 文件中定义函数：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">// 普通函数（非静态函数）</span><br><span class="line">void fun1(void) {</span><br><span class="line">	printf("fun1 was executed...\n");</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// static 修饰的函数叫静态函数</span><br><span class="line">static void fun2(void) {</span><br><span class="line">	printf("fun2 was executed...\n");</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>file04.c 文件中使用外部文件中的函数：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">fun1</span><span class="params">(<span class="type">void</span>)</span>; <span class="comment">// 使用 extern 引入外部文件中的非静态函数，不允许重新定义</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">fun2</span><span class="params">(<span class="type">void</span>)</span>; <span class="comment">// 可以引入外部文件中的静态函数，但是不能使用！ 除非自己重新定义</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">fun2</span><span class="params">()</span> {</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"fun2 was redefined\n"</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	fun1();</span><br><span class="line">	fun2();</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出节果：</p>
<p><img src="https://image.woodwhales.cn/053/images/10.png"></p>
<h2 id="系统函数库"><a href="#系统函数库" class="headerlink" title="系统函数库"></a>系统函数库</h2><h3 id="string-h-字符串函数库"><a href="#string-h-字符串函数库" class="headerlink" title="string.h 字符串函数库"></a>string.h 字符串函数库</h3><p>字符串操作常常依赖系统依赖提供的字符串函数：</p>
<h4 id="得到字符串的长度"><a href="#得到字符串的长度" class="headerlink" title="得到字符串的长度"></a>得到字符串的长度</h4><p><code>size_t strlen(const char *str)</code></p>
<p>计算字符串 str 的长度，直到空结束字符，但不包括空结束字符 。</p>
<h4 id="拷贝字符串"><a href="#拷贝字符串" class="headerlink" title="拷贝字符串"></a>拷贝字符串</h4><p><code>char *strcpy(char *dest, const char *src)</code></p>
<p>把 src 所指向的字符串复制到 dest。</p>
<h4 id="连接字符串"><a href="#连接字符串" class="headerlink" title="连接字符串"></a>连接字符串</h4><p><code>char *strcat(char *dest, const char *src)</code></p>
<p>把 src 所指向的字符串追加到 dest 所指向的字符串的结尾。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">char</span> src[<span class="number">50</span>], dest[<span class="number">50</span>];</span><br><span class="line"></span><br><span class="line">	<span class="type">char</span> * str = <span class="string">"woodwhales"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> len = <span class="built_in">strlen</span>(str); <span class="comment">// 计算字符串长度（以字符为单位）</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"0. str = %s, len = %d\n"</span>, str, len);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">strcpy</span>(src, <span class="string">"src str"</span>); <span class="comment">// strcpy 字符串拷贝，注意源字符串会被覆盖</span></span><br><span class="line">	<span class="built_in">strcpy</span>(dest, <span class="string">"dest str"</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"1. src = %s\n"</span>, src);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"2. dest = %s\n"</span>, dest);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">strcpy</span>(dest, <span class="string">"hello world"</span>); <span class="comment">// 证明 strcpy 字符串拷贝源字符串会被覆盖</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"3. dest = %s\n"</span>, dest);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">strcat</span>(dest, <span class="string">" woodwhales"</span>); <span class="comment">// strcpy 字符串拼接</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"4. dest = %s\n"</span>, dest);</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出节果：</p>
<p><img src="https://image.woodwhales.cn/053/images/11.png"></p>
<h3 id="time-h-时间日期函数库"><a href="#time-h-时间日期函数库" class="headerlink" title="time.h 时间日期函数库"></a>time.h 时间日期函数库</h3><h4 id="获取当前时间"><a href="#获取当前时间" class="headerlink" title="获取当前时间"></a>获取当前时间</h4><p><code>char *ctime(const time_t *timer)</code></p>
<p>返回一个表示当地时间的字符串，当地时间是基于参数 timer。</p>
<h4 id="时间差计算"><a href="#时间差计算" class="headerlink" title="时间差计算"></a>时间差计算</h4><p><code>double difftime(time_t time1, time_t time2)</code></p>
<p>返回 time1 和 time2 之间相差的秒数 (time1-time2)。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">time_t</span> currentTime; <span class="comment">// time.h 是一个结构体类型</span></span><br><span class="line">	time(&amp;currentTime); <span class="comment">// 完成初始化</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">// ctime 返回一个表示当地时间的字符串，当地时间是基于参数 timer</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"current time = %s"</span>, ctime(&amp;currentTime));</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出节果：</p>
<p><img src="https://image.woodwhales.cn/053/images/12.png"></p>
<p>计算某个函数的执行时间：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">function</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">10000000</span>; i++) {</span><br><span class="line">		<span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">10</span>; j++) {</span><br><span class="line">			sum += j;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">time_t</span> startTime, endTime; </span><br><span class="line">	</span><br><span class="line">	<span class="type">double</span> costTime;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"function is begining...\n"</span>);</span><br><span class="line">	time(&amp;startTime); <span class="comment">// 记录开始时间</span></span><br><span class="line"></span><br><span class="line">	function(); <span class="comment">// 执行函数</span></span><br><span class="line"></span><br><span class="line">	time(&amp;endTime); <span class="comment">// 记录结束时间</span></span><br><span class="line"></span><br><span class="line">	costTime = difftime(endTime, startTime);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"cost time = %f\n"</span>, costTime);</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出节果：</p>
<p><img src="https://image.woodwhales.cn/053/images/13.png"></p>
<h2 id="预处理命令"><a href="#预处理命令" class="headerlink" title="预处理命令"></a>预处理命令</h2><p>使用库函数之前，应该用<code>#include</code>引入对应的头文件。这种以<code>#</code>号开头的命令称为预处理命令。</p>
<p>这些在编译之前对源文件进行简单加工的过程，就称为<code>预处理</code>（即预先处理、提前处理）。</p>
<p>预处理主要是处理以<code>#</code>开头的命令，例如 #include &lt;stdio.h&gt; 等。预处理命令要放在所有函数之外，而且一般都放在源文件的前面。</p>
<p>预处理是 C 语言的一个重要功能，由预处理程序完成。<strong>当对一个源文件进行编译时， 系统将自动调用预处理程序对源程序中的预处理部分作处理，处理完毕自动进入对源程序的编译。</strong></p>
<p>C 语言提供了多种预处理功能，如宏定义、文件包含、条件编译等，合理地使用它们会使编写的程序便于阅读、修改、移植和调试，也有利于模块化程序设计。</p>
<p>应用场景：</p>
<p>开发一个C语言程序，让它暂停 5 秒以后再输出内容 “hello world”，并且要求跨平台，在 Windows 和 Linux 下都能运行，如何处理？</p>
<p>提示：</p>
<p>Windows 平台下的暂停函数的原型是<code>void Sleep(DWORD dwMilliseconds)</code>，参数的单位是”毫秒”，位于<code>&lt;windows.h&gt;</code>头文件。</p>
<p>Linux 平台下暂停函数的原型是<code>unsigned int sleep (unsigned int seconds)</code>，参数的单位是”秒”，位于<code>&lt;unistd.h&gt;</code>头文件。</p>
<p><code>#if</code>、<code>#elif</code>、<code>#endif</code>就是预处理命令，它们都是在编译之前由预处理程序来执行的。</p>
<p>代码：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> _WIN32</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">elif</span> __linux__</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	<span class="comment">// 不同的平台下调用不同的函数</span></span><br><span class="line">	<span class="meta">#<span class="keyword">if</span> _WIN32 <span class="comment">// 识别 windows 平台</span></span></span><br><span class="line">	Sleep(<span class="number">5000</span>);</span><br><span class="line">	<span class="meta">#<span class="keyword">elif</span> __linux__ <span class="comment">// 识别 linux 平台</span></span></span><br><span class="line">	sleep(<span class="number">5</span>);</span><br><span class="line">	<span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">"hello world"</span>);</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>上述源文件在预编译之后的源码中，会根据不同的平台生成对应的源码，如 windows 平台则会生成：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	Sleep(<span class="number">5000</span>);	</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">"hello world"</span>);</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h2 id="宏定义"><a href="#宏定义" class="headerlink" title="宏定义"></a>宏定义</h2><h3 id="宏定义命令"><a href="#宏定义命令" class="headerlink" title="宏定义命令"></a>宏定义命令</h3><p><code>#define</code>叫做宏定义命令，它也是 C 语言预处理命令的一种。所谓宏定义， 就是用一个标识符来表示一个字符串，如果在后面的代码中出现了该标识符，那么就全部替换成指定的字符串。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 100</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line">	<span class="type">int</span> sum = <span class="number">20</span> + N; <span class="comment">// int sum = 20 + 100</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, sum);</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出节果：</p>
<p><img src="https://image.woodwhales.cn/053/images/14.png"></p>
<p>从上述示例代码输出结果可以得出结论：</p>
<ul>
<li><code>int sum = 20 + N</code>，<code>N</code>被 100 代替了。</li>
<li><code>#define N 100</code>就是宏定义，<code>N</code>为宏名，100 是宏的内容（宏所表示的字符串）。在预处理阶段，对<br>程序中所有出现的<code>宏名</code>，预处理器都会用宏定义中的字符串去代换，这称为<code>宏替换</code>或<code>宏展开</code>。</li>
<li>宏定义是由源程序中的宏定义命令<code>#define</code>完成的，<strong>宏替换是由预处理程序完成的。</strong></li>
</ul>
<h3 id="宏定义的形式"><a href="#宏定义的形式" class="headerlink" title="宏定义的形式"></a>宏定义的形式</h3><p>#define 宏名 字符串</p>
<p><code>#</code>表示这是一条预处理命令，所有的预处理命令都以 # 开头。宏名是标识符的一种，命名规则和变量相同。字符串可以是数字、表达式、if 语句、函数等</p>
<p>这里所说的字符串是一般意义上的字符序列，不要和 C 语言中的字符串等同，它不需要双引号</p>
<p>程序中反复使用的表达式就可以使用宏定义</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 宏定义的宏展开仅仅是源码级别的字符串替换</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M (m*m+3*m)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N n*n+3*n </span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">int</span> sum1, sum2, m, n;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input a number: "</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;m, &amp;n);</span><br><span class="line">	</span><br><span class="line">	sum1 = <span class="number">3</span>*M + <span class="number">4</span>*M + <span class="number">5</span>*M; <span class="comment">// 宏展开为：3*(m*m+3*m) + 4*M(m*m+3*m) + 5*(m*m+3*m)</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"sum1 = %d\n"</span>, sum1);</span><br><span class="line">	</span><br><span class="line">	sum2 = <span class="number">3</span>*N + <span class="number">4</span>*N + <span class="number">5</span>*N; <span class="comment">// 宏展开为：3*n*n+3*n + 4*n*n+3*n + 5*n*n+3*n</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"sum2 = %d\n"</span>, sum2);</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出节果：</p>
<p><img src="https://image.woodwhales.cn/053/images/15.png"></p>
<h3 id="宏定义的注意事项"><a href="#宏定义的注意事项" class="headerlink" title="宏定义的注意事项"></a>宏定义的注意事项</h3><p>宏定义是用宏名来表示一个字符串，在宏展开时又以该字符串取代宏名，这只是一种简单的替换。字符串中可以含任何字符， 它可以是常数、表达式、if 语句、函数等，预处理程序对它不作任何检查，如有错误，只能在编译已被宏展开后的源程序时发现。</p>
<p>宏定义不是说明或语句，在行末不必加分号，如加上分号则连分号也一起替换</p>
<p><strong>宏定义必须写在函数之外，其作用域为宏定义命令起到源程序结束</strong>。如要终止其作用域可使用<code>#undef</code>命令</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PI 3.14159</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">function</span><span class="params">()</span> {</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"PI = %f"</span>, PI);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> PI <span class="comment">// 取消宏定义</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"PI=%f"</span>, PI); <span class="comment">// 错误! 这里不能使用到已经取消宏定义 PI 了</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>代码中的宏名如果被引号包围，那么预处理程序不对其作宏代替</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OK 200</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"OK\n"</span>); <span class="comment">// 被双引号括起来的宏名不会被宏展开</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>宏定义允许嵌套，在宏定义的字符串中可以使用已经定义的宏名，在宏展开时由预处理程序层层代换</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> PI 3.1415926</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> S PI*y*y</span></span><br></pre></td></tr></tbody></table></figure>

<p>习惯上 宏名用大写字母表示，以便于与变量区别。但也允许用小写字母</p>
<p>可用宏定义表示数据类型，使书写方便</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> UINT unsigned int</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	UINT a, b; <span class="comment">// 宏替换 unsigned int a, b;</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>宏定义表示数据类型和用<code>typedef</code>定义数据说明符的区别：宏定义只是简单的字符串替换，由预处理器来处理；而 typedef 是在编译阶段由编译器处理的，它并不是简单的字符串替换，而给原有的数据类型起一个新的名字，将它作为一种新的数据类型。</p>
<h3 id="带参数的宏定义"><a href="#带参数的宏定义" class="headerlink" title="带参数的宏定义"></a>带参数的宏定义</h3><p> C 语言允许宏带有参数。在宏定义中的参数称为<code>形式参数</code>，在宏调用中的参数称为<code>实际参数</code>，这点和函数有些类似</p>
<p>对带参数的宏，在展开过程中不仅要进行字符串替换，还要用实参去替换形参</p>
<p>带参宏定义的一般形式为<code>#define 宏名( 形参列表) 字符串</code>，在字符串中可以含有各个形参</p>
<p>带参宏调用的一般形式为：<code>宏名( 实参列表)</code></p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX(a, b) (a &gt; b) ? a : b</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line">	<span class="type">int</span> x , y, max;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input two numbers: "</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</span><br><span class="line"></span><br><span class="line">	max = MAX(x, y);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"max = %d\n"</span>, max);</span><br><span class="line">	</span><br><span class="line">	getchar();</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/16.png"></p>
<h3 id="带参宏定义的注意事项"><a href="#带参宏定义的注意事项" class="headerlink" title="带参宏定义的注意事项"></a>带参宏定义的注意事项</h3><p>带参宏定义中，形参之间可以出现空格，但是宏名和形参列表之间不能有空格出现</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MAX(a, b) (a &gt; b) ? a : b </span></span><br><span class="line"><span class="comment">// 上述如果写成了下面这样：宏名和参数列表之间有空格</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX (a, b) (a &gt; b) ? a : b</span></span><br><span class="line"><span class="comment">// 将被认为是无参宏定义，宏名 MAX 代表字符串(a, b) (a&gt;b) ? a : b</span></span><br><span class="line"><span class="comment">// 而不是 : MAX(a, b) 代表 (a&gt;b) ? a : b 了</span></span><br></pre></td></tr></tbody></table></figure>

<p>在带参宏定义中，不会为形式参数分配内存，因此不必指明数据类型。而在宏调用中，实参包含了具体的数据，要用它们去替换形参，因此实参必须要指明数据类型</p>
<p>在宏定义中，字符串内的形参通常要用括号括起来以避免出错。</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SQ1(y) (y) * (y)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SQ2(x) x * x</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line">	<span class="type">int</span> a, sq1, sq2;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input a number: "</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a);</span><br><span class="line"></span><br><span class="line">	sq1 = SQ1(a + <span class="number">1</span>); <span class="comment">// 宏展开：(a + 1) * (a + 1)</span></span><br><span class="line">	sq2 = SQ2(a + <span class="number">1</span>); <span class="comment">// 宏展开：a + 1 * a + 1</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"sq1 = %d\n"</span>, sq1);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"sq2 = %d\n"</span>, sq2);</span><br><span class="line">	</span><br><span class="line">	system(<span class="string">"pause"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/17.png"></p>
<h3 id="带参宏定义和函数的区别"><a href="#带参宏定义和函数的区别" class="headerlink" title="带参宏定义和函数的区别"></a>带参宏定义和函数的区别</h3><p>宏展开仅仅是字符串的替换，不会对表达式进行计算；宏在编译之前就被处理掉了，它没有机会参与编译，也不会占用内存。</p>
<p>函数是一段可以重复使用的代码，会被编译，会给它分配内存，每次调用函数，就是执行这块内存中的代码</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">SQ</span><span class="params">(<span class="type">int</span> y)</span> {</span><br><span class="line">	<span class="keyword">return</span> ((y)*(y));</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line">	<span class="type">int</span> i = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(i &lt;= <span class="number">5</span>) {</span><br><span class="line">		<span class="comment">// 因为i++是后自增，所以会先进行函数调用再自增</span></span><br><span class="line">		<span class="comment">// 由于自增的问题，所以输出的时候要减一下，表示当时调用函数时的值</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d^2 = %d\n"</span>, (i<span class="number">-1</span>), SQ(i++));</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	system(<span class="string">"pause"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/18.png"></p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/19.png"></p>
<h2 id="常见预处理命令"><a href="#常见预处理命令" class="headerlink" title="常见预处理命令"></a>常见预处理命令</h2><p>预处理指令是以<code>#</code>号开头的代码行，<code>#</code>号必须是该行除了任何空白字符外的第一个字符。</p>
<p><code>#</code>后是指令关键字，在关键字和<code>#</code>号之间允许存在任意个数的空白字符，整行语句构成了一条预处理指令，该指令将在编译器进行编译之前对源代码做某些转换。</p>
<table>
<thead>
<tr>
<th>指令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>#</td>
<td>空指令，无任何效果</td>
</tr>
<tr>
<td>#include</td>
<td>包含一个源代码文件</td>
</tr>
<tr>
<td>#define</td>
<td>定义宏</td>
</tr>
<tr>
<td>#undef</td>
<td>取消已定义的宏</td>
</tr>
<tr>
<td>#if</td>
<td>如果给定条件为真，则编译下面代码</td>
</tr>
<tr>
<td>#ifdef</td>
<td>如果宏已经定义，则编译下面代码</td>
</tr>
<tr>
<td>#ifndef</td>
<td>如果宏没有定义，则编译下面代码</td>
</tr>
<tr>
<td>#elif</td>
<td>如果前面的<code>#if</code>给定条件不为真，当前条件为真，则编译下面代码</td>
</tr>
<tr>
<td>#endif</td>
<td>结束一个<code>#if … #else</code>条件编译块</td>
</tr>
</tbody></table>
<h2 id="字符串的表示"><a href="#字符串的表示" class="headerlink" title="字符串的表示"></a>字符串的表示</h2><p>字符串可以使用字符数组表示，也可以使用字符指针指向一个字符串：</p>
<h3 id="用字符数组存放一个字符串"><a href="#用字符数组存放一个字符串" class="headerlink" title="用字符数组存放一个字符串"></a>用字符数组存放一个字符串</h3><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> str1[]=<span class="string">"hello world"</span>;</span><br><span class="line"><span class="type">char</span> str2[]= {<span class="string">'h'</span>, <span class="string">'e'</span>, <span class="string">'l'</span>, <span class="string">'l'</span>, <span class="string">'o'</span>};</span><br></pre></td></tr></tbody></table></figure>

<h3 id="用字符指针指向一个字符"><a href="#用字符指针指向一个字符" class="headerlink" title="用字符指针指向一个字符"></a>用字符指针指向一个字符</h3><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> * pStr = <span class="string">"yes"</span>;</span><br></pre></td></tr></tbody></table></figure>

<p>C语言对字符串常量”hello world”是按字符数组处理的，在内存中开辟了一个字符数组用来存放字符串常量，程序在定义字符串指针变量<code>pStr</code>时只是把字符串首地址（即存放字符串的字符数组的首地址）赋给<code>pStr</code>，图示：</p>
<p><img src="https://image.woodwhales.cn/053/images/20.png"></p>
<p>注意上图中的内存单元格中本质存储的不是字符，而是字符对应的 ASCII 码值。</p>
<p>细节注意：使用字符指针变量指向字符串时，首先这个指针变量会有自己的地址空间，在自己的地址空间中存储着字符数组的首地址。</p>
<p>示例代码：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line">	<span class="type">char</span> str1[] = <span class="string">"hello world"</span>;</span><br><span class="line">	<span class="type">char</span> str2[] = {<span class="string">"hello"</span>};</span><br><span class="line"></span><br><span class="line">	<span class="type">char</span> * pStr = <span class="string">"hello world"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"str1 = %p, &amp;str1[0] = %p\n"</span>, str1, &amp;str1[<span class="number">0</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"str2 = %p, &amp;str2[0] = %p\n"</span>, str2, &amp;str2[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"pStr = %p, &amp;pStr[0] = %p\n"</span>, pStr, &amp;pStr[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">	system(<span class="string">"pause"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/21.png">注意事项：</p>
<p>字符数组由若干个元素组成，每个元素放一个字符；而字符指针变量中存放的是地址（字符串/字符数组的首地址），绝不是将字符串放到字符指针变量中（是字符串首地址）</p>
<p>对字符数组只能对各个元素赋值，不能用以下方法对字符数组赋值</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> str[<span class="number">14</span>];</span><br><span class="line">str = <span class="string">"hello world"</span>; <span class="comment">// 错误, 因为在第一行执行完毕之后，str本身就被定义指向了一块地址，</span></span><br><span class="line">					 <span class="comment">// 这个地址是个常量值，不允许再被赋值了</span></span><br><span class="line">str[<span class="number">0</span>] = <span class="string">'m'</span>; <span class="comment">// 正确</span></span><br></pre></td></tr></tbody></table></figure>

<p>对字符指针变量，采用下面方法赋值是可以的：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> * PStr = <span class="string">"yes"</span>;</span><br><span class="line">pStr = <span class="string">"hello world"</span>;</span><br></pre></td></tr></tbody></table></figure>

<p>图示：</p>
<p><img src="https://image.woodwhales.cn/053/images/22.png"></p>
<p>小结：如果定义了一个字符数组，那么它有确定的内存地址（即字符数组名是一个常量）；而定义一个字符指针变量时，它并未指向某个确定的字符数据，并且可以多次赋值。</p>
<h2 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h2><p>指针是一个变量，其值为另一个变量的地址( 上一小节的意图已经说明 )，即<strong>内存位置的直接地址</strong>。就像其他变量或常量一样，在使用指针存储其他变量地址之前，对其进行声明。指针变量声明的一般形式为：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> *intPtr; <span class="comment">/* 一个整型的指针 */</span></span><br><span class="line"><span class="type">double</span> *doublePtr; <span class="comment">/* 一个 double 型的指针 */</span></span><br><span class="line"><span class="type">float</span> *floatPtr; <span class="comment">/* 一个浮点型的指针 */</span></span><br><span class="line"><span class="type">char</span> *charPtr; <span class="comment">/* 一个字符型的指针 */</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="指针的算术运算"><a href="#指针的算术运算" class="headerlink" title="指针的算术运算"></a>指针的算术运算</h3><p>指针是一个用数值表示的地址。可以对指针执行算术运算。可以对指针进行四种算术运算：++、–、+、-。</p>
<h4 id="指针递增操作（-）"><a href="#指针递增操作（-）" class="headerlink" title="指针递增操作（++）"></a>指针递增操作（++）</h4><p>数组在内存中是连续分布的。当对指针进行++时，指针会按照它指向的数据类型字节数大小增加，比如<code>int *</code>指针，每<code>++</code>一次就增加 4 个字节。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAX = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span> <span class="params">()</span> {</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> var[] = {<span class="number">10</span>, <span class="number">100</span>, <span class="number">200</span>}; <span class="comment">// 定义一个 int 类型的数组</span></span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> i, *ptr; <span class="comment">// 定义整型变量，其中 ptr 是整型变量的指针变量</span></span><br><span class="line">	</span><br><span class="line">	ptr = var; <span class="comment">// 对指针初始化操作，即将数组的首地址赋值给 ptr</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; MAX; i++) {</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"var[%d] = %d, &amp;var[%d] = %p \n"</span>, i, var[i], i, &amp;var[i]);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"ptr = %p, *ptr = %d \n"</span>, ptr, *ptr);</span><br><span class="line">		ptr++; <span class="comment">// 指针自增操作</span></span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出节果：</p>
<p><img src="https://image.woodwhales.cn/053/images/23.png"></p>
<p>从上图输出的结果可以看出，地址的自增操作，其地址的值是按照对应的指针类型的大小进行自增的。</p>
<h4 id="指针递减操作（–）"><a href="#指针递减操作（–）" class="headerlink" title="指针递减操作（–）"></a>指针递减操作（–）</h4><p>递减操作和递增操作同理。数组在内存中是连续分布的。当对指针进行–时，指针会按照它指向的数据类型字节数大小减少，比如 <code>int *</code>指针，每<code>--</code>一次 就减少 4 个字节。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAX = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span> <span class="params">()</span> {</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> var[] = {<span class="number">10</span>, <span class="number">100</span>, <span class="number">200</span>}; <span class="comment">// 定义一个 int 类型的数组</span></span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> i, *ptr; <span class="comment">// 定义整型变量，其中 ptr 是整型变量的指针变量</span></span><br><span class="line">	</span><br><span class="line">	ptr = &amp;var[MAX<span class="number">-1</span>]; <span class="comment">// 对指针初始化操作，即将数组的首地址赋值给 ptr</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> ( i = MAX<span class="number">-1</span>; i &gt;= <span class="number">0</span> ; i--) {</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"var[%d] = %d, &amp;var[%d] = %p \n"</span>, i, var[i], i, &amp;var[i]);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"ptr = %p, *ptr = %d \n"</span>, ptr, *ptr);</span><br><span class="line">		ptr--; <span class="comment">// 指针自减操作</span></span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出节果：</p>
<p><img src="https://image.woodwhales.cn/053/images/24.png"></p>
<h4 id="指针的-操作"><a href="#指针的-操作" class="headerlink" title="指针的+/-操作"></a>指针的+/-操作</h4><p>当可以对指针按照指定的字节数大小进行 + 或者 – 的操作，可以快速定位你要的地址。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAX = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span> <span class="params">()</span> {</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> var[] = {<span class="number">10</span>, <span class="number">100</span>, <span class="number">200</span>};</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> i, *ptr; </span><br><span class="line">	</span><br><span class="line">	ptr = var; </span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> index = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">	ptr += index; <span class="comment">// 表示地址值 + index*指针类型大小</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"var[%d] = %d, &amp;var[%d] = %p \n"</span>, index, var[index], index, &amp;var[index]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"ptr = %p, *ptr = %d \n"</span>, ptr, *ptr);</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出节果：</p>
<p><img src="https://image.woodwhales.cn/053/images/25.png"></p>
<h3 id="指针数组"><a href="#指针数组" class="headerlink" title="指针数组"></a>指针数组</h3><p>要让数组的元素 指向 int 或其他数据类型的地址(指针)。可以使用指针数组。</p>
<p>指针数组定义：数据类型 *指针数组名[大小]。</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> *ptr[<span class="number">3</span>];</span><br></pre></td></tr></tbody></table></figure>

<p>ptr 声明为一个指针数组</p>
<p>由 3 个整数指针组成。因此，ptr 中的每个元素，都是一个指向 int 值的指针。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAX = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span> <span class="params">()</span> {</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> var[] = {<span class="number">10</span>, <span class="number">100</span>, <span class="number">200</span>};</span><br><span class="line">	<span class="type">int</span> i, *ptr[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; MAX; i++) {</span><br><span class="line">		ptr[i] = &amp;var[i]; <span class="comment">/* 赋值为整数的地址 */</span></span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; MAX; i++) {</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Value of var[%d] = %d\n"</span>, i, *ptr[i] );</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Value of &amp;ptr[%d] = %p\n"</span>, i, &amp;ptr[i] );</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出节果：</p>
<p><img src="https://image.woodwhales.cn/053/images/26.png"></p>
<p>内存布局图：</p>
<p><img src="https://image.woodwhales.cn/053/images/27.png"></p>
<h3 id="指针数组应用实例"><a href="#指针数组应用实例" class="headerlink" title="指针数组应用实例"></a>指针数组应用实例</h3><p>定义一个指向字符的指针数组来存储字符串列表(四大名著书名)， 并通过遍历 该指针数组，显示字符串信息，即：定义一个指针数组，该数组的每个元素，指向的是一个字符串。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span> <span class="params">()</span> {</span><br><span class="line">	<span class="comment">// 定义一个指针数组，该数组的每个元素，指向的是一个字符串</span></span><br><span class="line">	<span class="type">char</span> * books[] = {</span><br><span class="line">		<span class="string">"三国演义"</span>,</span><br><span class="line">		<span class="string">"西游记"</span>,</span><br><span class="line">		<span class="string">"红楼梦"</span>,</span><br><span class="line">		<span class="string">"水浒传"</span></span><br><span class="line">	};</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> i, len = <span class="number">4</span>;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; len; i++) {</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\nbooks[%d] --&gt; %s"</span>, i, books[i]);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出节果：</p>
<p><img src="https://image.woodwhales.cn/053/images/28.png"></p>
<h3 id="二级及多重指针"><a href="#二级及多重指针" class="headerlink" title="二级及多重指针"></a>二级及多重指针</h3><p>指向指针的指针是一种 多级间接寻址的形式，或者说是一个指针链。通常，一个指针包含一个变量的地址。当我们定义一个指向指针的指针时，第一个指针包含了第二个指针的地址，第二个指针指向包含实际值的位置。</p>
<p><img src="https://image.woodwhales.cn/053/images/29.png"></p>
<p>一个指向指针的指针变量必须如下声明，即在变量名前放置两个星号。</p>
<p>声明了一个指向 int 类型指针的指针：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> **ptr; <span class="comment">// ptr 的类型是：int **</span></span><br></pre></td></tr></tbody></table></figure>

<p>当一个目标值被一个指针间接指向到另一个指针时，访问这个值需要使用两个星号运算符，比如<code>**ptr</code></p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span> <span class="params">()</span> {</span><br><span class="line">	<span class="type">int</span> var;</span><br><span class="line">	<span class="type">int</span> *ptr;</span><br><span class="line">	<span class="type">int</span> **pptr;</span><br><span class="line"></span><br><span class="line">	var = <span class="number">3000</span>;</span><br><span class="line">	ptr = &amp;var;</span><br><span class="line">	pptr = &amp;ptr;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"var address = %p , var = %d \n"</span>, &amp;var, var);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"ptr address = %p , ptr = %p , *ptr = %d \n"</span>, &amp;ptr, ptr, *ptr);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"pptr address = %p , pptr = %p , **ptr = %d \n"</span>, &amp;pptr, pptr, **pptr);</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出节果：</p>
<p><img src="https://image.woodwhales.cn/053/images/30.png"></p>
<h2 id="指针函数"><a href="#指针函数" class="headerlink" title="指针函数"></a>指针函数</h2><p>当函数的形参类型是指针类型时，是使用该函数时，需要传递指针，或者地址，或者数组给该形参</p>
<h3 id="传递指针-地址-给函数"><a href="#传递指针-地址-给函数" class="headerlink" title="传递指针(地址)给函数"></a>传递指针(地址)给函数</h3><p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">test</span><span class="params">(<span class="type">int</span> *p)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> i, num=<span class="number">90</span>;</span><br><span class="line">	<span class="type">int</span> *p = &amp;num;</span><br><span class="line">	</span><br><span class="line">	test(&amp;num); <span class="comment">//传地址</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\nmain() 中的num=%d"</span>, num);</span><br><span class="line">	</span><br><span class="line">	test(p); <span class="comment">//传指针</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\nmain() 中的num=%d"</span>, num);</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">test</span><span class="params">(<span class="type">int</span> *p)</span> {</span><br><span class="line">	*p += <span class="number">1</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/31.png"></p>
<h3 id="返回指针的函数"><a href="#返回指针的函数" class="headerlink" title="返回指针的函数"></a>返回指针的函数</h3><p>C语言 允许函数的返回值是一个指针（地址），这样的函数称为指针函数。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//函数返回的char * (指针)</span></span><br><span class="line"><span class="type">char</span> * <span class="title function_">strlong</span><span class="params">(<span class="type">char</span> *str1, <span class="type">char</span> *str2)</span>{ 	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\nstr1.len = %d str2.len = %d"</span>, <span class="built_in">strlen</span>(str1), <span class="built_in">strlen</span>(str1));</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">strlen</span>(str1) &gt;= <span class="built_in">strlen</span>(str2)){</span><br><span class="line">		<span class="keyword">return</span> str1;</span><br><span class="line">	} <span class="keyword">else</span> {</span><br><span class="line">		<span class="keyword">return</span> str2;</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line">	<span class="type">char</span> str1[<span class="number">30</span>], str2[<span class="number">30</span>], *str;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n请输入第1个字符串"</span>);</span><br><span class="line">	gets(str1);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n请输入第2个字符串"</span>);</span><br><span class="line">	gets(str2);</span><br><span class="line">	</span><br><span class="line">	str = strlong(str1, str2);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\nLonger string: %s \n"</span>, str);</span><br><span class="line">	</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/32.png"></p>
<h3 id="返回指针函数的注意事项"><a href="#返回指针函数的注意事项" class="headerlink" title="返回指针函数的注意事项"></a>返回指针函数的注意事项</h3><p>用指针作为函数返回值时需要注意，函数运行结束后会销毁在它内部定义的所有局部数据，包括局部变量、局部数组和形式参数，函数返回的指针不能指向这些数据。</p>
<blockquote>
<p>函数运行结束后会销 毁该函数所 有的局部数据 ，这里所谓的销毁并不是将局部数据所占用的内存全部清零，而是程序放弃对它的使用权限，后面的代码可以使用这块内存。</p>
</blockquote>
<p><strong>C 语言不支持在调用函数时返回局部变量的地址，如果确实有这样的需求，需要定义局部变量为 static 变量</strong>。因为被 static  修饰的局部变量会存储在静态数据区，而不是栈中。</p>
<p>代码示例（危险的使用示例）：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> * <span class="title function_">func</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">int</span> n = <span class="number">100</span>;</span><br><span class="line">	<span class="keyword">return</span> &amp;n;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">    </span><br><span class="line">	<span class="type">int</span> *p = func(); <span class="comment">// 调用完 func() 方法，其方法中的局部变量的使用权被回收了</span></span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\nhello"</span>); <span class="comment">// 这行打印语句可能会使用到上述被回收使用权的内存空间</span></span><br><span class="line">	</span><br><span class="line">	n = *p; <span class="comment">// 由于func()方法的局部变量空间使用权被回收了，那么它的地址会被其他程序使用到，会修改成其他的值</span></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\nvalue = %d\n"</span>, n);</span><br><span class="line">	</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/33.png"></p>
<p>代码示例（正确的使用示例，使用 static 修饰局部变量）：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> * <span class="title function_">func</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">static</span> <span class="type">int</span> n = <span class="number">100</span>; <span class="comment">// static 修饰的局部变量会存储在静态数据区，而不是栈里面</span></span><br><span class="line">	<span class="keyword">return</span> &amp;n;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> *p = func(); <span class="comment">// 调用完 func() 方法，其方法中的静态局部变量的使用权不会被回收</span></span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\nhello"</span>); </span><br><span class="line">	</span><br><span class="line">	n = *p;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\nvalue = %d\n"</span>, n);</span><br><span class="line">	</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/34.png"></p>
<h3 id="应用实例"><a href="#应用实例" class="headerlink" title="应用实例"></a>应用实例</h3><p>编写一个函数，它会生成 10 个随机数，并使用表示指针的数组名（即第一个数组元素的地址）来返回它们。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> * <span class="title function_">getRandArray</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">static</span> <span class="type">int</span> arr[<span class="number">10</span>] ; <span class="comment">// static 修饰的局部变量会存储在静态数据区，而不是栈里面</span></span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"===getRandArray start=== \n"</span>);</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) {</span><br><span class="line">		arr[i] = rand();</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"arr[%d] = %d\n"</span>, i, arr[i]);</span><br><span class="line">	}</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"===getRandArray end=== \n"</span>);</span><br><span class="line">	<span class="keyword">return</span> arr;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> * ptr = getRandArray();</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) {</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"arr[%d] = %d \n"</span>, i, *(ptr + i));</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/35.png"></p>
<h2 id="函数指针"><a href="#函数指针" class="headerlink" title="函数指针"></a>函数指针</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>一个函数总是占用一段连续的内存区域，函数名在表达式中有时也会被转换为该函数所在内存区域的首地址，这和数组名非常类似。</p>
<p><strong>把函数的这个首地址（或称入口地址）赋予一个指针变量，使指针变量指向函数所在的内存区域，然后通过指针变量就可以找到并调用该函数。这种指针就是函数指 针。</strong></p>
<h3 id="函数指针定义"><a href="#函数指针定义" class="headerlink" title="函数指针定义"></a>函数指针定义</h3><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">returnType (*pointerName)(param <span class="built_in">list</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>说明：</p>
<ul>
<li>returnType 为函数返回值类型</li>
<li>pointerName 为指针名称</li>
<li>param list 为函数指针指向的函数参数列表</li>
<li>参数列表中可以同时给出参数的类型和名称，也可以只给出参数的类型，省略参数的名称</li>
<li>注意<code>()</code>的优先级高于<code>*</code>，第一个括号不能省略，如果写作<code>returnType *pointerName(param list);</code>就成了函数原型，它表明函数的返回值类型为<code>returnType *</code></li>
</ul>
<h3 id="应用实例-1"><a href="#应用实例-1" class="headerlink" title="应用实例"></a>应用实例</h3><p>用 函数指 针来实现对函数的调用，返回两个整数中的最大值。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">max</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> {</span><br><span class="line">	<span class="keyword">return</span> a &gt; b ? a : b;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line">	<span class="type">int</span> x, y, maxVal;</span><br><span class="line">	<span class="type">int</span> (*pmax)(<span class="type">int</span>, <span class="type">int</span>) = max; <span class="comment">// 使用pmax函数指针接收 max 函数的地址</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"Input two numbers:"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</span><br><span class="line">	</span><br><span class="line">	maxVal = (*pmax)(x, y); <span class="comment">// 使用函数指针调用 max 函数</span></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"Max value: %d\n"</span>, maxVal);</span><br><span class="line">	</span><br><span class="line">	getchar();</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/36.png"></p>
<h2 id="回调函数"><a href="#回调函数" class="headerlink" title="回调函数"></a>回调函数</h2><h3 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h3><p>函数指针变量可以作为某个函数的参数来使用的，回调函数就是一个通过函数指针调用的函数。</p>
<p>简单的讲：回调函数是由别人的函数执行时调用你传入的函数（通过函数指针完成）。</p>
<h3 id="应用实例-2"><a href="#应用实例-2" class="headerlink" title="应用实例"></a>应用实例</h3><p>使用回调函数的方式，给一个整型数组<code>int arr[10]</code>赋 10 个随机数。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">getRandomValue</span><span class="params">(<span class="type">void</span>)</span> {</span><br><span class="line">	<span class="keyword">return</span> rand();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">initAray</span><span class="params">(<span class="type">int</span> * <span class="built_in">array</span>, <span class="type">int</span> arraySize,<span class="type">int</span> (* getRandomValuePtr)(<span class="type">void</span>))</span> {</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; arraySize; i++) {</span><br><span class="line">		<span class="built_in">array</span>[i] = getRandomValuePtr();</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line">	<span class="type">int</span> arr[<span class="number">10</span>];</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	initAray(arr, <span class="number">10</span>, getRandomValue);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) {</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n arr[%d] = %d"</span>, i, arr[i]);</span><br><span class="line">	}</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/37.png"></p>
<h2 id="空指针"><a href="#空指针" class="headerlink" title="空指针"></a>空指针</h2><p>指针变量存放的是地址，从这个角度看指针的本质就是地址。</p>
<p>变量声明的时候，如果没有确切的地址赋值，为指针变量赋一个 NULL 值是好的编程习惯。</p>
<p>赋为 NULL 值的指针被称为空指针，NULL 指针是一个定义在标准库<code>&lt;stdio.h&gt;</code>中的值为零的常量<code>#define NULL 0</code></p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line">	<span class="type">int</span> * ptr = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="type">int</span> num = <span class="number">10</span>;</span><br><span class="line">	ptr = &amp;num;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"*ptr = %d \n"</span>, *ptr);</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/38.png"></p>
<h2 id="内存动态分配"><a href="#内存动态分配" class="headerlink" title="内存动态分配"></a>内存动态分配</h2><p>C 程序中，不同数据在内存中分配说明：</p>
<p>全局变量：内存中的静态存储区</p>
<p>非静态的局部变量：内存中的动态存储区（stack 栈）</p>
<p>临时使用的数据：建立动态内存分配区域，需要时随时开辟，不需要时及时释放（heap 堆）</p>
<p>根据需要向系统申请所需大小的空间，由于未在声明部分定义其为变量或者数组，不能通过变量名或者数组名来引用这些数据，只能通过指针来引用）</p>
<p><img src="https://image.woodwhales.cn/053/images/39.png"></p>
<h2 id="内存动态分配的相关函数"><a href="#内存动态分配的相关函数" class="headerlink" title="内存动态分配的相关函数"></a>内存动态分配的相关函数</h2><p> 头文件<code>#Include &lt;stdlib.h&gt;</code>声明了四个关于内存动态分配的函数：</p>
<h3 id="malloc"><a href="#malloc" class="headerlink" title="malloc"></a>malloc</h3><p>函数原型：<code>void * malloc (usigned int size)</code></p>
<p>作用：在内存的 动态存储 区( 堆区)中分配一个长度为<code>size</code>的<strong>连续空间</strong>。</p>
<p>形参<code>size</code>的类型为<strong>无符号整型</strong>，函数返回值是所分配区域的第一个字节的地址，即此函数是一个指针型函数，返回的指针指向该分配域的开头位置。</p>
<p><code>malloc(100);</code>表示开辟 100 字节的临时空间，返回值为其第一个字节的地址。</p>
<h3 id="calloc"><a href="#calloc" class="headerlink" title="calloc"></a>calloc</h3><p>函数原型：<code>void * calloc (unsigned n, unsigned size) </code></p>
<p>作用：在内存的动态存储区中分配<code>n</code>个长度为<code>size</code>的连续空间，这个空间一般比较大，足以保存一个数组。</p>
<p>用 calloc 函数可以为一维数组开辟动态存储空间，n 为数组元素个数，每个元素长度为 size。</p>
<p>函数返回指向所分配域的起始位置的指针，分配不成功，返回NULL。</p>
<p><code>p = calloc(50, 4);</code> 表示开辟<code>50*4</code>个字节临时空间，把起始地址分配给指针变量 p</p>
<h3 id="free"><a href="#free" class="headerlink" title="free"></a>free</h3><p>函数原型：<code>void free (void *p) </code></p>
<p>作用：释放变量<code>p</code>所指向的动态空间，使这部分空间能重新被其他变量使用。</p>
<p><code>p</code>是最近一次调用<code>calloc</code>或<code>malloc</code>函数时的函数返回值。</p>
<p>free 函数无返回值</p>
<p><code>free(p);</code>表示释放<code>p</code>所指向的已分配的动态空间</p>
<h3 id="realloc"><a href="#realloc" class="headerlink" title="realloc"></a>realloc</h3><p>函数原型：<code>void *realloc (void *p, unsigned int size)</code></p>
<p>作用：重新分配<code>malloc</code>或<code>calloc</code>函数获得的动态空间大小，将p指向的动态空间大小改变为<code>size</code>，<code>p</code>的值不变，分配失败返回NULL。</p>
<p><code>realloc(p, 50);</code> 表示将<code>p</code>所指向的已分配的动态空间改为 50 字节。</p>
<h3 id="返回类型说明"><a href="#返回类型说明" class="headerlink" title="返回类型说明"></a>返回类型说明</h3><p>C99 标准把以上的<code>malloc</code>，<code>calloc</code>，<code>realloc</code>函数的基类型定为<code>void</code>类型，这种指针称为无类型指针（typeless pointer），即不指向哪一种具体的类型数据，只表示用来指向一个抽象的类型的数据，即仅提供一个纯地址，而不能指向任何具体的对象。</p>
<h3 id="void指针类型"><a href="#void指针类型" class="headerlink" title="void指针类型"></a>void指针类型</h3><p>C99 允许使用基类型为 void 的指针类型。可以定义一个基类型为 void 的指针变量（即 void * 型变量），它不指向任何类型的数据。请注意：不要把“指向 void 类型”理解为能指向“任何的类型”的数据，而应该理解为“指向空类型”或“不指向确定的类型”的数据。在将它的值赋给另一指针变量时由系统对它进行类型转换，使之适合于被赋值的变量的类型。例如：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a = <span class="number">3</span>;					<span class="comment">// 定义 a 为整型变量</span></span><br><span class="line"><span class="type">int</span> * p1 = &amp;a;				<span class="comment">// p1 指向 int 型变量</span></span><br><span class="line"><span class="type">char</span> * p2;					<span class="comment">// p2 指向 char 型变量</span></span><br><span class="line"><span class="type">void</span> * p3;					<span class="comment">// p3 为无类型指针变量（基类型为 void 型）</span></span><br><span class="line">p3 = (<span class="type">void</span> *)p1;			<span class="comment">// 将 p1 的值转换为 void * 类型，然后赋值给 p3</span></span><br><span class="line">p2 = (<span class="type">char</span> *)p3;			<span class="comment">// 将 p3 的值转换为 char * 类型，然后赋值给 p2</span></span><br><span class="line">prinf(<span class="string">"%d"</span>, *p1); 			<span class="comment">// 合法，输出 a 的值</span></span><br><span class="line">p3 = &amp;a; prinf(<span class="string">"%d"</span>, *p3); 	<span class="comment">// 错误，p3是无指向的，不能指向a</span></span><br></pre></td></tr></tbody></table></figure>

<p>说明：当把 void 指针赋值给不同基类型的指针变量（或相反）时，C99 及以上的编译系统会自动进行转换，不必用户自己强制转换。例如：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p3 = &amp;a;</span><br></pre></td></tr></tbody></table></figure>

<p>相当于<code>p3 = (void *)&amp;a;</code>，赋值后 p3 得到 a 的纯地址，但并不指向 a，不能通过 *p3 输出 a 的值。</p>
<h3 id="应用实例-3"><a href="#应用实例-3" class="headerlink" title="应用实例"></a>应用实例</h3><p>动态创建数组，输入 5 个学生的成绩，另外一个函数检测成绩低于 60 分的，输出不合格的成绩。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">check</span><span class="params">(<span class="type">int</span> *)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">int</span> * p,i;</span><br><span class="line">	p = (<span class="type">int</span> *)<span class="built_in">malloc</span>(<span class="number">5</span>*<span class="keyword">sizeof</span>(<span class="type">int</span>)); <span class="comment">// 在堆中开辟 5 个int大小的内存空间，共 5*4 = 20个字节</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>( i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++){</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, p + i);</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	check(p); <span class="comment">// 遍历int数组，打印不及格的成绩</span></span><br><span class="line">	<span class="built_in">free</span>(p); <span class="comment">// 释放堆内存</span></span><br><span class="line">	getchar();</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">check</span><span class="params">(<span class="type">int</span> * ptr)</span> {</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n 不及格的成绩有："</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i &lt; <span class="number">5</span>; i++) {</span><br><span class="line">		<span class="keyword">if</span>(ptr[i] &lt; <span class="number">60</span>) {</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d "</span>, ptr[i]);</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/40.png"></p>
<h3 id="动态分配内存的基本原则"><a href="#动态分配内存的基本原则" class="headerlink" title="动态分配内存的基本原则"></a>动态分配内存的基本原则</h3><p>避免分配大量的小内存块。分配堆上的内存有一些系统开销，所以分配许多小的内存块比分配几个大内存块的系统开销大</p>
<p>仅在需要时分配内存。只要 使用完堆上的内存块， 就需要及时释放它（如果使用动态分配内存，需要遵守原则：<strong>谁分配，谁释放</strong>）， 否则可能出现内存泄漏</p>
<p>总是确保释放以分配的内存。在编写分配内存的代码时，就要确定在代码的什么地方释放内存</p>
<p>在释放内存之前，确保不会无意中覆盖堆上已分配的内存地址，否则程序就会出现内存泄漏 。在循环中分配内存时，要特别小心。</p>
<h2 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h2><p>结构体的声明方式：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> 结构体名称 {</span></span><br><span class="line">    成员列表;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>

<p>注意：结构体名称一般首字母大写，结构体的花括号后面紧跟<code>;</code>分号。</p>
<p>形如：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> {</span></span><br><span class="line">    <span class="type">char</span> * name; <span class="comment">// 姓名</span></span><br><span class="line">    <span class="type">int</span> num; <span class="comment">// 学号</span></span><br><span class="line">    <span class="type">int</span> age; <span class="comment">// 年龄</span></span><br><span class="line">    <span class="type">char</span> group; <span class="comment">// 所在学习小组</span></span><br><span class="line">    <span class="type">double</span> score; <span class="comment">// 成绩</span></span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>

<h3 id="成员"><a href="#成员" class="headerlink" title="成员"></a>成员</h3><p>从叫法上看：有些书上称为成员，有些书说 结构体包含的变量</p>
<p>成员是结构体的一个组成部分，一般是<code>基本数据类型</code>、也可以是<code>数组</code>、<code>指针</code>、<code>结构体</code>等 。</p>
<h3 id="声明细节"><a href="#声明细节" class="headerlink" title="声明细节"></a>声明细节</h3><p>成员声明语法同变量一声明方式一样，示例： <code>数据类型 成员名;</code></p>
<p>字段的类型可以为：基本类型、数组或指针、结构体等。</p>
<p>在创建一个结构体变量后，需要给成员赋值，如果没有赋值就使用可能导致程序异常终止。</p>
<p>不同结构体变量的成员是独立，互不影响，一个结构体变量的成员更改，不影响另外一个。</p>
<h3 id="定义方式"><a href="#定义方式" class="headerlink" title="定义方式"></a>定义方式</h3><p>方式一：先定义结构体，再创建结构体变量</p>
<p>示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> {</span></span><br><span class="line">  <span class="type">char</span> * name;</span><br><span class="line">  <span class="type">int</span> age;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> <span class="title">stu1</span>, <span class="title">stu2</span>;</span> </span><br></pre></td></tr></tbody></table></figure>

<p>方式二：在定义结构体的同时定义结构体变量</p>
<p>示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> {</span></span><br><span class="line">  <span class="type">char</span> * name;</span><br><span class="line">  <span class="type">int</span> age;</span><br><span class="line">} stu1, stu2; </span><br></pre></td></tr></tbody></table></figure>

<p>方式三：如果只需要 stu1 和 stu2 两个变量，后面不需要再使用该结构体数据类型去定义其他变量，在定义结构体时可以不给出结构体名称。这种结构体称为匿名结构体。</p>
<p>示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> {</span></span><br><span class="line">  <span class="type">char</span> * name;</span><br><span class="line">  <span class="type">int</span> age;</span><br><span class="line">} stu1, stu2; </span><br></pre></td></tr></tbody></table></figure>

<h3 id="成员值的获取和赋值"><a href="#成员值的获取和赋值" class="headerlink" title="成员值的获取和赋值"></a>成员值的获取和赋值</h3><p>结构体和数组类似，也是一组数据的集合，整体使用没有太大的意义。数组使用下标<code>[]</code>获取单个元素，结构体使用点号<code>.</code>获取单个成员。获取结构体成员的一般格式为：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">结构体变量名.成员名;</span><br></pre></td></tr></tbody></table></figure>

<p>赋值操作示例 1：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> {</span></span><br><span class="line">  <span class="type">char</span> * name;</span><br><span class="line">  <span class="type">int</span> age;</span><br><span class="line">} stu1, stu2;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 赋值操作</span></span><br><span class="line">stu1.name = “woodwhales”;</span><br><span class="line">stu1.age = <span class="number">10</span>;</span><br></pre></td></tr></tbody></table></figure>

<p>赋值操作示例 2：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> {</span></span><br><span class="line">  <span class="type">char</span> * name;</span><br><span class="line">  <span class="type">int</span> age;</span><br><span class="line">} stu1 = {<span class="string">"woodwhales"</span>, <span class="number">12</span>}, stu2 = {<span class="string">"king"</span>, <span class="number">15</span>};</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> <span class="title">stu3</span> =</span> {<span class="string">"tim"</span>, <span class="number">16</span>};</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> <span class="title">stu4</span>;</span></span><br><span class="line"><span class="comment">// stu4 = {"tom", 20};  // 不允许这样方式赋值</span></span><br><span class="line">stu4.name = <span class="string">"jack"</span>; <span class="comment">// 结构体变量定义时没有整体赋值，那么只能只用.一个个对成员变量赋值</span></span><br><span class="line">stu4.age = <span class="number">16</span>; <span class="comment">// 结构体变量定义时没有整体赋值，那么只能只用.一个个对成员变量赋值</span></span><br></pre></td></tr></tbody></table></figure>

<p>说明：结构体声明时带不带结构体名称不会影响赋值上述俩种赋值操作。</p>
<h3 id="应用实例-4"><a href="#应用实例-4" class="headerlink" title="应用实例"></a>应用实例</h3><h4 id="小狗案例"><a href="#小狗案例" class="headerlink" title="小狗案例"></a>小狗案例</h4><p>编写一个 Dog 结构体，包含 name(char[10])、age(int)、weight(double) 属性</p>
<p>编写一个 say 函数，返回字符串，方法返回信息中包含所有成员值。</p>
<p>在 main 方法中，创建 Dog 结构体变量，调用 say 函数，将调用结果打印输出 。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Dog</span> {</span></span><br><span class="line">	<span class="type">char</span> * name;</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line">	<span class="type">double</span> weight;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> * <span class="title function_">say</span><span class="params">(<span class="keyword">struct</span> Dog dog)</span> {</span><br><span class="line">	<span class="type">static</span> <span class="type">char</span> info[<span class="number">50</span>];</span><br><span class="line">	<span class="built_in">sprintf</span>(info, <span class="string">"name = %s, age = %d, weight = %2f\n"</span>, dog.name, dog.age, dog.weight);</span><br><span class="line">	dog.name = <span class="string">"小黑"</span>; <span class="comment">// 结构体变量默认是值传递，调用者的结构体不会被影响</span></span><br><span class="line">	<span class="keyword">return</span> info;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Dog</span> <span class="title">dog</span>;</span></span><br><span class="line">	<span class="type">char</span> * info = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">	dog.name = <span class="string">"旺财"</span>;</span><br><span class="line">	dog.age = <span class="number">5</span>;</span><br><span class="line">	dog.weight = <span class="number">10.5</span>;</span><br><span class="line"></span><br><span class="line">	info = say(dog); <span class="comment">// 结构体变量默认是值传递</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\nsay() return = %s"</span>, info);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"main() dog.name = %s \n"</span>, dog.name);</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/41.png"></p>
<h4 id="景区门票案例"><a href="#景区门票案例" class="headerlink" title="景区门票案例"></a>景区门票案例</h4><p>一个景区根据游人的年龄收取不同价格的门票。</p>
<p>请编写游人结构体(Visitor)，根据年龄段决定能够购买的门票价格并输出</p>
<p>规则：年龄大于18，门票为20元，其它情况免费。</p>
<p>可以循环从控制台输入名字和年龄，打印门票收费情况, 如果名字输入 n，则退出程序。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Visitor</span> {</span></span><br><span class="line">	<span class="type">char</span> name[<span class="number">10</span>];</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line">	<span class="type">double</span> pay;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="comment">// 因为结构体默认是值传递，每次函数被调用就会拷贝一份完整数据，效率较低。</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">ticket</span><span class="params">(<span class="keyword">struct</span> Visitor * visitor)</span> {</span><br><span class="line">	<span class="keyword">if</span>((*visitor).age &gt; <span class="number">18</span>) {</span><br><span class="line">		(*visitor).pay = <span class="number">20</span>;</span><br><span class="line">	} <span class="keyword">else</span> {</span><br><span class="line">		(*visitor).pay = <span class="number">0</span>;</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Visitor</span> <span class="title">visitor</span>;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) {</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n 请输入游客的名字："</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, visitor.name);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(!<span class="built_in">strcmp</span>(<span class="string">"n"</span>, visitor.name)) {</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		}</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n 请输入游客的年龄："</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;visitor.age);</span><br><span class="line">		ticket(&amp;visitor);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n 该游客应付票价为：%.2f\n"</span>, visitor.pay);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n 程序退出"</span>);</span><br><span class="line">	getchar();</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/42.png"></p>
<h2 id="共用体"><a href="#共用体" class="headerlink" title="共用体"></a>共用体</h2><p>共用体（Union ）属于 构造类型，它可以包含多个类型不同的成员。和结构体非常类似，但是也有不同的地方。</p>
<p>共用体有时也被称为联合或者联合体，定义格式为：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">union</span> 共用体名 {</span></span><br><span class="line"> 	成员列表;   </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p> 结构体和共用体的区别在于：结构体的各个成员会占用不同的内存，互相之间没有影响；而<strong>共用体的所有成员占用同一段内存，修改一个成员会影响其余所有成员。</strong></p>
<h3 id="定义方式-1"><a href="#定义方式-1" class="headerlink" title="定义方式"></a>定义方式</h3><p>方式一：先定义共用体，再创建共用体变量</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">data</span> {</span></span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="type">char</span> ch;</span><br><span class="line">    <span class="type">double</span> f;</span><br><span class="line">};</span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">data</span> <span class="title">a</span>, <span class="title">b</span>, <span class="title">c</span>;</span></span><br></pre></td></tr></tbody></table></figure>

<p>方式二：在定义共用体的同时定义共用体变量</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">data</span> {</span></span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="type">char</span> ch;</span><br><span class="line">    <span class="type">double</span> f;</span><br><span class="line">} a, b, c;</span><br></pre></td></tr></tbody></table></figure>

<p>方式三：如果只需要 a、b、c 三个变量，后面不需要再使用该共用体数据类型去定义其他变量，在定义共用体时可以不给出共用体名称。这种共用体称为匿名共用体。</p>
<p>示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">union</span> {</span></span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="type">char</span> ch;</span><br><span class="line">    <span class="type">double</span> f;</span><br><span class="line">} a, b, c;</span><br></pre></td></tr></tbody></table></figure>

<p>共用体成员</p>
<h3 id="占用空间细节注意"><a href="#占用空间细节注意" class="headerlink" title="占用空间细节注意"></a>占用空间细节注意</h3><p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Data 共用体的包含三个成员，三个成员的空间是共享的，该共用体空间的大小以占用空间最大的成员为准</span></span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">Data</span> {</span></span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="type">char</span> ch;</span><br><span class="line">	<span class="type">short</span> m;</span><br><span class="line">};</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line">	<span class="class"><span class="keyword">union</span> <span class="title">Data</span> <span class="title">a</span>;</span></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d, %d\n"</span>, <span class="keyword">sizeof</span>(a), <span class="keyword">sizeof</span>(<span class="keyword">union</span> Data));</span><br><span class="line">	</span><br><span class="line">	a.n = <span class="number">0x40</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d, %c, %d\n"</span>, a.n, a.ch, a.m);</span><br><span class="line">	</span><br><span class="line">	a.ch = <span class="string">'9'</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d, %c, %d\n"</span>, a.n, a.ch, a.m);</span><br><span class="line">	</span><br><span class="line">	a.m = <span class="number">0x2059</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d, %c, %d\n"</span>, a.n, a.ch, a.m);</span><br><span class="line">	</span><br><span class="line">	a.n = <span class="number">0x3E25AD54</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d, %c, %d\n"</span>, a.n, a.ch, a.m);</span><br><span class="line">	</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/43.png"></p>
<h3 id="内存占用详解"><a href="#内存占用详解" class="headerlink" title="内存占用详解"></a>内存占用详解</h3><p>上述输出结果的内存示意图：</p>
<p>共用体的占用空间是以占用空间最大的成员为准，因此初始化的共用体内存占用情况为：</p>
<p><img src="https://image.woodwhales.cn/053/images/44.png"></p>
<p>成员变量的占用空间均是从低位对齐，赋值操作也是从低位填充：</p>
<p><img src="https://image.woodwhales.cn/053/images/45.png"></p>
<p>读取共用体中的成员变量，也是根据该成员变量的类型大小，从低位开始读取：</p>
<p><img src="https://image.woodwhales.cn/053/images/46.png"></p>
<p>因此共用体内存状态处于上述图示所示时，依次读取成员变量的值为：</p>
<p>char 类型读取到的十进制数值为：64，对应 ASCII 码表为<code>@</code>符号。</p>
<p>short 类型读取到的十进制数值为：64。</p>
<p>int 类型读取到的十进制数值为：64。</p>
<p>再次对 int 类型的成员变量进行赋值操作：</p>
<p><img src="https://image.woodwhales.cn/053/images/47.png"></p>
<p>再次读取共用体中成员变量的值，图示：</p>
<p><img src="https://image.woodwhales.cn/053/images/48.png"></p>
<p>char 类型读取到的十进制数值为：89，对应 ASCII 码表为<code>Y</code>符号。 </p>
<p>short 类型读取到的十进制数值为：8281。</p>
<p>int 类型读取到的十进制数值为：8281。</p>
<p>再次赋值，次读取：</p>
<p><img src="https://image.woodwhales.cn/053/images/49.png"></p>
<p>其中 short 类型首先读取到的二进制为：<code>1010,1101,0101,0100 </code>，这个二进制对计算机来说是补码，因此计算之前要进行转码，将符号位不变，其他位取反并加 1，得到的值是个正数，再加上负号，就是十进制原码数值。</p>
<p>char 类型读取到的十进制数值为：84，对应 ASCII 码表为<code>T</code>符号。 </p>
<h3 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h3><p>现有一张关于学生信息和教师信息的表格：</p>
<p>学生信息包括姓名、编号、性别、职业、分数。</p>
<p>教师的信息包括姓名、编号、性别、职业、教学科目。</p>
<p>请看下面的表格：</p>
<table>
<thead>
<tr>
<th>name</th>
<th>num</th>
<th>gender</th>
<th>profession</th>
<th>score/course</th>
</tr>
</thead>
<tbody><tr>
<td>孙二娘</td>
<td>501</td>
<td>女（f）</td>
<td>学生（s）</td>
<td>90.5</td>
</tr>
<tr>
<td>吴用</td>
<td>302</td>
<td>男（m）</td>
<td>老师（t）</td>
<td>math</td>
</tr>
<tr>
<td>顾大嫂</td>
<td>109</td>
<td>女（f）</td>
<td>老师（t）</td>
<td>english</td>
</tr>
<tr>
<td>林冲</td>
<td>982</td>
<td>男（m）</td>
<td>学生（s）</td>
<td>95.5</td>
</tr>
</tbody></table>
<p>请使用共用体编程完成。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TOTAL 2 <span class="comment">//人员总数</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Person</span> {</span></span><br><span class="line">	<span class="type">char</span> name[<span class="number">20</span>];</span><br><span class="line">	<span class="type">int</span> num;</span><br><span class="line">	<span class="type">char</span> gender;</span><br><span class="line">	<span class="type">char</span> profession;</span><br><span class="line">	<span class="class"><span class="keyword">union</span> {</span> <span class="comment">// 匿名的共用体</span></span><br><span class="line">		<span class="type">float</span> score;</span><br><span class="line">		<span class="type">char</span> course[<span class="number">20</span>];</span><br><span class="line">	} sc;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Person</span> <span class="title">persons</span>[<span class="title">TOTAL</span>];</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; TOTAL; i++) {</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"input info : "</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s %d %c %c"</span>, persons[i].name, &amp;(persons[i].num),</span><br><span class="line">			&amp;(persons[i].gender), &amp;(persons[i].profession));</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(persons[i].profession == <span class="string">'s'</span>) {</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"请输入该学生的成绩 ： "</span>);</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;persons[i].sc.score);</span><br><span class="line">		} <span class="keyword">else</span> {</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"请输入该老师的课程 ： "</span>);</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%s"</span>, persons[i].sc.course);</span><br><span class="line">		}</span><br><span class="line">		fflush(<span class="built_in">stdin</span>);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\nName\t\tNum\t\tGender\t\tProfession\tScore/Course\n"</span>);</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; TOTAL; i++) {</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%s\t\t%d\t\t%c\t\t%c\t\t"</span>, persons[i].name, persons[i].num, persons[i].gender, persons[i].profession);</span><br><span class="line">		<span class="keyword">if</span>(persons[i].profession == <span class="string">'s'</span>) {</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%.2f\n"</span>, persons[i].sc.score);</span><br><span class="line">		} <span class="keyword">else</span> {</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%s\n"</span>, persons[i].sc.course);</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	getchar();</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/50.png"></p>
<h2 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h2><p>文件是数据源（保存数据的地方）的一种，比如大家经常使用的 word 文档，txt 文件，excel 文件等都是文件。文件最主要的作用就是保存数据，它既可以保存一张图片，也可以保持视频，声音等。</p>
<p>文件在程序中是以流的形式来操作的。</p>
<p><img src="https://image.woodwhales.cn/053/images/51.png"></p>
<p>流：数据在数据源（文件）和程序（内存）之间经历的路径</p>
<p>输 入流：数据从数据源（文件）到程序（内存）的路径</p>
<p>输 出流：数据从程序（内存）到数据源（文件）的路径</p>
<p>C 标准库<code>stdio.h</code>该头文件定义了三个变量类型、一些宏和各种函数来执行输入和输出，在开发过程中，可以查询手册。</p>
<h3 id="输入-输出"><a href="#输入-输出" class="headerlink" title="输入&amp;输出"></a>输入&amp;输出</h3><p>当我们提到<code>输入</code>时，这意味着要向程序写入一些数据。输入可以是以文件的形式或从命令行中进行。C 语言提供了一系列内置的函数来读取给定的输入，并根据需要写入到程序中。</p>
<p>当我们提到<code>输出</code>时，这意味着要在屏幕上、打印机上或任意文件中显示一些数据。C 语言提供了一系列内置的函数来输出数据到计算机屏幕上和保存数据到文本文件或二进制文件中。</p>
<h3 id="标准文件"><a href="#标准文件" class="headerlink" title="标准文件"></a>标准文件</h3><p><strong>C 语言把所有的设备都当作文件。</strong>所以设备（比如显示器）被处理的方式与文件相同。以下三个文件会在程序执行时自动打开，以便访问键盘和屏幕。</p>
<table>
<thead>
<tr>
<th>标准文件</th>
<th>文件指针</th>
<th>设备</th>
</tr>
</thead>
<tbody><tr>
<td>标准输入</td>
<td>stdin</td>
<td>键盘</td>
</tr>
<tr>
<td>标准输出</td>
<td>stdout</td>
<td>屏幕</td>
</tr>
<tr>
<td>标准错误</td>
<td>stderr</td>
<td>您的屏幕</td>
</tr>
</tbody></table>
<p><strong>文件指针是访问文件的方式</strong>，我们会讲解如何从屏幕读取值以及如何把结果输出到屏幕上。</p>
<p>C 语言中的 I/O （输入/输出）通常使用<code>printf() </code> 和<code>scanf()</code>两个函数。<code>scanf()</code>函数用于从标准输入（键盘）读取并格式化，<code>printf()</code>函数发送格式化输出到标准输出（屏幕）。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span> <span class="comment">// 执行 printf() 函数需要该库</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"hello"</span>); <span class="comment">// 显示引号中的内容</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h3><h3 id="getchar-putchar-函数"><a href="#getchar-putchar-函数" class="headerlink" title="getchar() &amp; putchar() 函数"></a>getchar() &amp; putchar() 函数</h3><p><code>int getchar(void)</code>函数从屏幕读取下一个可用的字符，并把它返回为一个整数。这个函数在同一个时间内只会读取一个单一的字符。您可以在循环内使用这个方法，以便从屏幕上读取多个字符。</p>
<p><code>int putchar(int c)</code>函数把字符输出到屏幕上，并返回相同的字符。这个函数在同一个时间内只会输出一个单一的字符。您可以在循环内使用这个方法，以便在屏幕上输出多个字符。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">( )</span> {</span><br><span class="line">	<span class="type">int</span> c;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>( <span class="string">"Enter a value :"</span>);</span><br><span class="line">	c = getchar(); <span class="comment">// 接收键盘输入的单一字符</span></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>( <span class="string">"\nYou entered: "</span>);</span><br><span class="line">	<span class="built_in">putchar</span>(c); <span class="comment">// 输出键盘输入的字符到屏幕</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	getchar(); <span class="comment">// 过滤键盘输入的回车符号</span></span><br><span class="line">	getchar(); <span class="comment">// 暂停程序</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/52.png"></p>
<h3 id="gets-puts-函数"><a href="#gets-puts-函数" class="headerlink" title="gets() &amp; puts() 函数"></a>gets() &amp; puts() 函数</h3><p><code>char *gets(char *s)</code>函数从<code>stdin</code>读取一行到 s 所指向的缓冲区，直到一个终止符或<code>EOF</code>。</p>
<p><code>int puts(const char *s)</code>函数把字符串 s 和一个尾随的换行符写入到<code>stdout</code>。</p>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">( )</span> {</span><br><span class="line">	<span class="type">char</span> str[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>( <span class="string">"Enter value :"</span>);</span><br><span class="line">	gets(str); <span class="comment">// 接收键盘输入的一串字符串</span></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>( <span class="string">"\nYou entered: "</span>);</span><br><span class="line">	<span class="built_in">puts</span>(str); <span class="comment">// 输出键盘输入的字符串到屏幕</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	getchar(); <span class="comment">// 暂停程序</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/53.png"></p>
<h3 id="scanf-和-和-printf-函数"><a href="#scanf-和-和-printf-函数" class="headerlink" title="scanf() 和 和 printf() 函数"></a>scanf() 和 和 printf() 函数</h3><p><code>int scanf(const char *format, ...)</code>函数从标准输入流<code>stdin</code>读取输入，并根据提供的<code>format</code>来浏览输入。</p>
<p><code>int printf(const char *format, ...)</code>函数把输出写入到标准输出流<code>stdout</code>，并根据提供的格式产生输出。</p>
<blockquote>
<p><code>format</code>可以是一个简单的常量字符串，但是您可以分别指定 %s、%d、%c、%f 等来输出或读取字符串、整数、字符或浮点数。还有许多其他可用的格式选项，可以根据需要使用。如需了解完整的细节，可以查看这些函数的参考手册。</p>
</blockquote>
<p>代码示例：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">( )</span> {</span><br><span class="line">	<span class="type">char</span> str[<span class="number">100</span>];</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>( <span class="string">"Enter value :"</span>);</span><br><span class="line">	<span class="comment">// 要求出入字符串之后必须有一个空格才能接收一个整型数字，不按照格式输入，那么程序可能会报异常</span></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%s %d"</span>, str, &amp;i);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>( <span class="string">"\nYou entered: %s, %d"</span>, str, i);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	getchar(); <span class="comment">// 过滤回车</span></span><br><span class="line">	getchar(); <span class="comment">// 暂停程序</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/54.png"></p>
<h3 id="文件读写"><a href="#文件读写" class="headerlink" title="文件读写"></a>文件读写</h3><p>一个文件，无论它是文本文件还是二进制文件，都是代表了一系列的字节。C 语言不仅提供了访问顶层的函数，也提供了底层（OS）调用来处理存储设备上的文件。</p>
<h4 id="打开文件"><a href="#打开文件" class="headerlink" title="打开文件"></a>打开文件</h4><p>使用<code>fopen()</code>函数来创建一个新的文件或者打开一个已有的文件，这个调用会初始化类型<code>FILE</code>的一个对象，类型<code>FILE</code>包含了所有用来控制流的必要的信息。</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FILE *<span class="title function_">fopen</span><span class="params">( <span class="type">const</span> <span class="type">char</span> * filename, <span class="type">const</span> <span class="type">char</span> * mode )</span>;</span><br></pre></td></tr></tbody></table></figure>

<p>在这里，<strong>filename</strong> 是字符串，用来命名文件，访问模式 <strong>mode</strong> 的值可以是下列值中的一个： </p>
<table>
<thead>
<tr>
<th>模式</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>r</td>
<td>打开一个已有的文本文件，允许读取文件。</td>
</tr>
<tr>
<td>w</td>
<td>打开一个文本文件，允许写入文件。如果文件不存在，则会创建一个新文件。在这里，您的程序会从文件的开头写入内容。<strong>如果文件存在，则该会被截断为零长度，重新写入。</strong></td>
</tr>
<tr>
<td>a</td>
<td>打开一个文本文件，以<strong>追加模式写入文件</strong>。如果文件不存在，则会创建一个新文件。在这里，您的程序会在已有的文件内容中追加内容。</td>
</tr>
<tr>
<td>r+</td>
<td>打开一个文本文件，允许读写文件。</td>
</tr>
<tr>
<td>w+</td>
<td>打开一个文本文件，允许读写文件。如果文件已存在，则文件会被截断为零长度，如果文件不存在，则会创建一个新文件。</td>
</tr>
<tr>
<td>a+</td>
<td>打开一个文本文件，允许读写文件。如果文件不存在，则会创建一个新文件。读取会从文件的开头开始，写入则只能是追加模式。</td>
</tr>
</tbody></table>
<p>如果处理的是<strong>二进制文件（图片、视频等）</strong>，则需使用下面的访问模式来取代上面的访问模式：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"rb"</span>, <span class="string">"wb"</span>, <span class="string">"ab"</span>, <span class="string">"rb+"</span>, <span class="string">"r+b"</span>, <span class="string">"wb+"</span>, <span class="string">"w+b"</span>, <span class="string">"ab+"</span>, <span class="string">"a+b"</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>b</code>是指 binary，代表二进制的意思。</p>
<p>综上，对于<code>w</code>或<code>w+</code>模式一定要慎重小心使用。</p>
<h4 id="关闭文件"><a href="#关闭文件" class="headerlink" title="关闭文件"></a>关闭文件</h4><p> 为了关闭文件，请使用<code>fclose()</code>函数。函数的原型如下： </p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fclose</span><span class="params">( FILE *fp )</span>;</span><br></pre></td></tr></tbody></table></figure>

<p>如果成功关闭文件，<strong>fclose()</strong> 函数返回零，如果关闭文件时发生错误，函数返回 <strong>EOF</strong>。这个函数实际上，会清空缓冲区中的数据，关闭文件，并释放用于该文件的所有内存。EOF 是一个定义在头文件 <strong>stdio.h</strong> 中的常量。 </p>
<p><strong>使用完文件（读或写文件）之后，一定要将该文件关闭。</strong></p>
<h4 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h4><p> 把字符写入到流中的最简单的函数： </p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fputc</span><span class="params">( <span class="type">int</span> c, FILE *fp )</span>;</span><br></pre></td></tr></tbody></table></figure>

<p> 函数 <strong>fputc()</strong> 把参数 c 的字符值写入到 fp 所指向的输出流中。如果写入成功，它会返回写入的字符，如果发生错误，则会返回 <strong>EOF</strong>。您可以使用下面的函数来把一个以 null 结尾的字符串写入到流中： </p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fputs</span><span class="params">( <span class="type">const</span> <span class="type">char</span> *s, FILE *fp )</span>;</span><br></pre></td></tr></tbody></table></figure>

<p>说明：函数 <strong>fputs()</strong> 把字符串 <strong>s</strong> 写入到 fp 所指向的输出流中。如果写入成功，它会返回一个非负值，如果发生错误，则会返回 <strong>EOF</strong>。您也可以使用<code>int fprintf(FILE \*fp, const char \*format, ...)</code>函数来写把一个字符串写入到文件中。</p>
<p>代码示例：</p>
<p>以下程序执行之前，D 盘符的根目录下没有一个叫：hello.txt 的文件，以下程序使用了<code>w</code>模式打开并操作文件，那么在指定目录下没有该文件就会创建这个文件。如果该文件已存在，那么就会清空该文件原有的内容。因此谨慎测试本程序。</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">( )</span> {</span><br><span class="line">	FILE * fp = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="type">int</span> result;</span><br><span class="line">	fp = fopen(<span class="string">"D:\\hello.txt"</span>, <span class="string">"w"</span>); <span class="comment">// w 模式会将已存在的文件内容进行清空！</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(fp, <span class="string">"woodwhales.github.io\n"</span>);</span><br><span class="line">	<span class="built_in">fputs</span>(<span class="string">"hello world\n"</span>, fp);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 一定要关闭文件</span></span><br><span class="line">	result = fclose(fp);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(!result) {</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"文件创建并写入成功！\n"</span>);</span><br><span class="line">	} <span class="keyword">else</span> {</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"文件操作失败！\n"</span>);</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出效果：</p>
<p><img src="https://image.woodwhales.cn/053/images/55.png"></p>
<p>写入文件切记要关闭文件，否则文件中新写的内容不会被成功写入文件。</p>
<h4 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h4><p> 下面是从文件读取单个字符的最简单的函数： </p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fgetc</span><span class="params">( FILE * fp )</span>;</span><br></pre></td></tr></tbody></table></figure>

<p> <strong>fgetc()</strong> 函数从 fp 所指向的输入文件中读取一个字符。返回值是读取的字符，如果发生错误则返回 <strong>EOF</strong>。</p>
<p>下面的函数允许您从流中读取一个字符串： </p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *<span class="title function_">fgets</span><span class="params">( <span class="type">char</span> *buf, <span class="type">int</span> n, FILE *fp )</span>;</span><br></pre></td></tr></tbody></table></figure>

<p>说明：</p>
<p>函数 <strong>fgets()</strong> 从 fp 所指向的输入流中读取 n - 1 个字符。它会把读取的字符串复制到缓冲区 <strong>buf</strong>，并在最后追加一个 <strong>null</strong> 字符来终止字符串。</p>
<p>如果这个函数在读取最后一个字符之前就遇到一个换行符 ‘\n’ 或文件的末尾 EOF，则只会返回读取到的字符，包括换行符。</p>
<p>也可以使用 <strong>int fscanf(FILE *fp, const char *format, …)</strong> 函数来从文件中读取字符串，但是在遇到第一个回车字符时，它会停止读取。</p>
<p>代码示例：</p>
<p>以下代码执行之前，在 D 盘符已经存在一个名称叫：hello.txt 的文件，里面存储了一些文本内容。</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">	FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="type">char</span> buff[<span class="number">1024</span>];</span><br><span class="line"> </span><br><span class="line">	fp = fopen(<span class="string">"D:\\hello.txt"</span>, <span class="string">"r"</span>);</span><br><span class="line">	<span class="comment">// 读取文件方式1</span></span><br><span class="line">	<span class="comment">//fscanf(fp, "%s", buff); // 只能读取一行</span></span><br><span class="line">	<span class="comment">//printf("%s\n", buff); // 输出读取到的文件内容</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 读取文件方式2</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(fgets(buff, <span class="number">1024</span>, fp) != <span class="literal">NULL</span>) { <span class="comment">// 循环读取文件内容，如果读到NULL就结束读取</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%s"</span>, buff);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	fclose(fp);</span><br><span class="line">	</span><br><span class="line">	getchar();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出结果：</p>
<p><img src="https://image.woodwhales.cn/053/images/56.png"></p>

      
    </div>
    
    
    

	
	
		
	<div class="updated">
		<svg xmlns="http://www.w3.org/2000/svg" width="130" height="20">
			<linearGradient id="b" x2="0" y2="100%">
				<stop offset="0" stop-color="#bbb" stop-opacity=".1"></stop>
				<stop offset="1" stop-opacity=".1"></stop>
			</linearGradient>
			<clipPath id="a">
				<rect width="130" height="20" rx="3" fill="#fff"></rect>
			</clipPath>
			<g clip-path="url(#a)">
				<path fill="#555" d="M0 0h55v20H0z"></path>
				<path fill="#97CA00" d="M55 0h75v20H55z"></path>
				<path fill="url(#b)" d="M0 0h130v20H0z"></path>
			</g>
			<g fill="#fff" text-anchor="middle" font-family="Menlo,monospace" font-size="110">
				<text x="285" y="150" fill="#010101" fill-opacity=".3" textLength="450" transform="scale(.1)">updated</text>
				<text x="285" y="140" textLength="450" transform="scale(.1)">updated</text>
				<text x="915" y="150" fill="#010101" fill-opacity=".3" textLength="650" transform="scale(.1)">2025-04-06</text>
				<text x="915" y="140" textLength="650" transform="scale(.1)">2025-04-06</text>
			</g>
			
		</svg>
	</div>


  <div style="text-align:center;font-size:13px;letter-spacing:10px;user-select:none;margin-top:20px;color:#bbb">本文结束<i class="fa fa-star"></i>感谢阅读</div>

	
	
	
    

    
	
	<div>
      
        
<div class="my_post_copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
  <!-- JS库 sweetalert 可修改路径 -->
  <script src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <p><span>本文标题:</span><a href="/2019/11/18/053/">C 语言中的细节知识点</a></p>
  <p><span>本文作者:</span><a href="https://woodwhales.cn/" title="访问 woodwhales 的个人博客">woodwhales</a></p>
  <p><span>原始链接:</span><a href="/2019/11/18/053/" title="C 语言中的细节知识点">https://woodwhales.cn/2019/11/18/053/</a>
    <span class="copy-path"  title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="https://woodwhales.cn/2019/11/18/053/"  aria-label="复制成功！"></i></span>
  </p>
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>  
</div>
<script> 
    var clipboard = new Clipboard('.fa-clipboard');
    $(".fa-clipboard").click(function(){
      clipboard.on('success', function(){
        swal({   
          title: "",   
          text: '复制成功',
          icon: "success", 
          showConfirmButton: true
          });
    });
    });  
</script>

      
	</div>

    
	
    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/C-%E8%AF%AD%E8%A8%80/" rel="tag"><i class="fa fa-tag"></i> C 语言</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/11/11/052/" rel="next" title="git 设置本地配置多个账户对应不同的 ssh key">
                <i class="fa fa-chevron-left"></i> git 设置本地配置多个账户对应不同的 ssh key
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/11/24/054/" rel="prev" title="计算机语言及操作系统发展史">
                计算机语言及操作系统发展史 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1815293530059355"
     crossorigin="anonymous"></script>

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/uploads/avatar-woodwhale.png"
                alt="woodwhales" />
            
              <p class="site-author-name" itemprop="name">woodwhales</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">102</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">63</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">83</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/woodwhales" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:woodwhales@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://juejin.im/user/5b1f7a2f518825137f0d31d1" target="_blank" title="掘金">
                      
                        <i class="fa fa-fw fa-book"></i>掘金</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.cnblogs.com/mujingyu/" target="_blank" title="博客园">
                      
                        <i class="fa fa-fw fa-laptop"></i>博客园</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-globe"></i>
                神奇的链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://music.cloudcoders.cn" title="开源音乐播放器" rel="external nofollow" target="_blank">开源音乐播放器</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://image.woodwhales.cn/" title="woodwhales-image-store" rel="external nofollow" target="_blank">woodwhales-image-store</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.bilibili.com/video/av6211226" title="尼古拉·特斯拉：发明了现代世界的人" rel="external nofollow" target="_blank">尼古拉·特斯拉：发明了现代世界的人</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.bilibili.com/video/av21376839" title="计算机科学速成课：Crash Course" rel="external nofollow" target="_blank">计算机科学速成课：Crash Course</a>
                  </li>
                
              </ul>
			  
			  <div id="days"></div>
<script>
	function show_date_time(){
	window.setTimeout("show_date_time()", 1000);
	BirthDay=new Date("12/21/2018 00:00:00");
	today=new Date();
	timeold=(today.getTime()-BirthDay.getTime());
	sectimeold=timeold/1000
	secondsold=Math.floor(sectimeold);
	msPerDay=24*60*60*1000
	e_daysold=timeold/msPerDay
	daysold=Math.floor(e_daysold);
	e_hrsold=(e_daysold-daysold)*24;
	hrsold=setzero(Math.floor(e_hrsold));
	e_minsold=(e_hrsold-hrsold)*60;
	minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
	seconds=setzero(Math.floor((e_minsold-minsold)*60));
	document.getElementById('days').innerHTML="已运行 "+daysold+" 天 "+hrsold+" 小时 "+minsold+" 分 "+seconds+" 秒";
	}
	function setzero(i){
	if (i<10)
	{i="0" + i};
	return i;
	}
	show_date_time();
</script>
            </div>
          

          <!--<div id="days"></div>
<script>
	function show_date_time(){
	window.setTimeout("show_date_time()", 1000);
	BirthDay=new Date("12/21/2018 00:00:00");
	today=new Date();
	timeold=(today.getTime()-BirthDay.getTime());
	sectimeold=timeold/1000
	secondsold=Math.floor(sectimeold);
	msPerDay=24*60*60*1000
	e_daysold=timeold/msPerDay
	daysold=Math.floor(e_daysold);
	e_hrsold=(e_daysold-daysold)*24;
	hrsold=setzero(Math.floor(e_hrsold));
	e_minsold=(e_hrsold-hrsold)*60;
	minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
	seconds=setzero(Math.floor((e_minsold-minsold)*60));
	document.getElementById('days').innerHTML="已运行 "+daysold+" 天 "+hrsold+" 小时 "+minsold+" 分 "+seconds+" 秒";
	}
	function setzero(i){
	if (i<10)
	{i="0" + i};
	return i;
	}
	show_date_time();
</script>-->
        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E9%87%8F%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="nav-text">常量的定义</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#const"><span class="nav-text">const</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#define"><span class="nav-text">#define</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#const-%E5%92%8C-define-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-text">const 和 #define 的区别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%96%E6%A8%A1%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-text">取模运算符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E4%B8%AD%E7%9A%84%E8%87%AA%E5%8A%A8%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="nav-text">算术运算中的自动类型转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%A2%9E-%E8%87%AA%E5%87%8F%E8%BF%90%E7%AE%97"><span class="nav-text">自增&#x2F;自减运算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E5%92%8C%E6%8C%87%E9%92%88"><span class="nav-text">变量和指针</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-text">变量的作用域</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#static-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="nav-text">static 关键字</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E4%BD%BF%E7%94%A8-static"><span class="nav-text">局部变量使用 static</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E4%BD%BF%E7%94%A8-static"><span class="nav-text">全局变量使用 static</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8-static"><span class="nav-text">函数使用 static</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E5%87%BD%E6%95%B0%E5%BA%93"><span class="nav-text">系统函数库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#string-h-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0%E5%BA%93"><span class="nav-text">string.h 字符串函数库</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BE%97%E5%88%B0%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E9%95%BF%E5%BA%A6"><span class="nav-text">得到字符串的长度</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8B%B7%E8%B4%9D%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-text">拷贝字符串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-text">连接字符串</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#time-h-%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0%E5%BA%93"><span class="nav-text">time.h 时间日期函数库</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4"><span class="nav-text">获取当前时间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%B6%E9%97%B4%E5%B7%AE%E8%AE%A1%E7%AE%97"><span class="nav-text">时间差计算</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%84%E5%A4%84%E7%90%86%E5%91%BD%E4%BB%A4"><span class="nav-text">预处理命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%8F%E5%AE%9A%E4%B9%89"><span class="nav-text">宏定义</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%8F%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4"><span class="nav-text">宏定义命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%8F%E5%AE%9A%E4%B9%89%E7%9A%84%E5%BD%A2%E5%BC%8F"><span class="nav-text">宏定义的形式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%8F%E5%AE%9A%E4%B9%89%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-text">宏定义的注意事项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%A6%E5%8F%82%E6%95%B0%E7%9A%84%E5%AE%8F%E5%AE%9A%E4%B9%89"><span class="nav-text">带参数的宏定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%A6%E5%8F%82%E5%AE%8F%E5%AE%9A%E4%B9%89%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-text">带参宏定义的注意事项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%A6%E5%8F%82%E5%AE%8F%E5%AE%9A%E4%B9%89%E5%92%8C%E5%87%BD%E6%95%B0%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-text">带参宏定义和函数的区别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E9%A2%84%E5%A4%84%E7%90%86%E5%91%BD%E4%BB%A4"><span class="nav-text">常见预处理命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E8%A1%A8%E7%A4%BA"><span class="nav-text">字符串的表示</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8%E5%AD%97%E7%AC%A6%E6%95%B0%E7%BB%84%E5%AD%98%E6%94%BE%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-text">用字符数组存放一个字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8%E5%AD%97%E7%AC%A6%E6%8C%87%E9%92%88%E6%8C%87%E5%90%91%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6"><span class="nav-text">用字符指针指向一个字符</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E9%92%88"><span class="nav-text">指针</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%87%E9%92%88%E7%9A%84%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97"><span class="nav-text">指针的算术运算</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%87%E9%92%88%E9%80%92%E5%A2%9E%E6%93%8D%E4%BD%9C%EF%BC%88-%EF%BC%89"><span class="nav-text">指针递增操作（++）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%87%E9%92%88%E9%80%92%E5%87%8F%E6%93%8D%E4%BD%9C%EF%BC%88%E2%80%93%EF%BC%89"><span class="nav-text">指针递减操作（–）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%87%E9%92%88%E7%9A%84-%E6%93%8D%E4%BD%9C"><span class="nav-text">指针的+&#x2F;-操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%87%E9%92%88%E6%95%B0%E7%BB%84"><span class="nav-text">指针数组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%87%E9%92%88%E6%95%B0%E7%BB%84%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B"><span class="nav-text">指针数组应用实例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E7%BA%A7%E5%8F%8A%E5%A4%9A%E9%87%8D%E6%8C%87%E9%92%88"><span class="nav-text">二级及多重指针</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E9%92%88%E5%87%BD%E6%95%B0"><span class="nav-text">指针函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%A0%E9%80%92%E6%8C%87%E9%92%88-%E5%9C%B0%E5%9D%80-%E7%BB%99%E5%87%BD%E6%95%B0"><span class="nav-text">传递指针(地址)给函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E6%8C%87%E9%92%88%E7%9A%84%E5%87%BD%E6%95%B0"><span class="nav-text">返回指针的函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E6%8C%87%E9%92%88%E5%87%BD%E6%95%B0%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-text">返回指针函数的注意事项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B"><span class="nav-text">应用实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88"><span class="nav-text">函数指针</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5"><span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88%E5%AE%9A%E4%B9%89"><span class="nav-text">函数指针定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-1"><span class="nav-text">应用实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0"><span class="nav-text">回调函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5-1"><span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-2"><span class="nav-text">应用实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A9%BA%E6%8C%87%E9%92%88"><span class="nav-text">空指针</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%8A%A8%E6%80%81%E5%88%86%E9%85%8D"><span class="nav-text">内存动态分配</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%8A%A8%E6%80%81%E5%88%86%E9%85%8D%E7%9A%84%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="nav-text">内存动态分配的相关函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#malloc"><span class="nav-text">malloc</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#calloc"><span class="nav-text">calloc</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#free"><span class="nav-text">free</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#realloc"><span class="nav-text">realloc</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E7%B1%BB%E5%9E%8B%E8%AF%B4%E6%98%8E"><span class="nav-text">返回类型说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#void%E6%8C%87%E9%92%88%E7%B1%BB%E5%9E%8B"><span class="nav-text">void指针类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-3"><span class="nav-text">应用实例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E5%88%86%E9%85%8D%E5%86%85%E5%AD%98%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99"><span class="nav-text">动态分配内存的基本原则</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-text">结构体</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%90%E5%91%98"><span class="nav-text">成员</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A3%B0%E6%98%8E%E7%BB%86%E8%8A%82"><span class="nav-text">声明细节</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E6%96%B9%E5%BC%8F"><span class="nav-text">定义方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%90%E5%91%98%E5%80%BC%E7%9A%84%E8%8E%B7%E5%8F%96%E5%92%8C%E8%B5%8B%E5%80%BC"><span class="nav-text">成员值的获取和赋值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-4"><span class="nav-text">应用实例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B0%8F%E7%8B%97%E6%A1%88%E4%BE%8B"><span class="nav-text">小狗案例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%99%AF%E5%8C%BA%E9%97%A8%E7%A5%A8%E6%A1%88%E4%BE%8B"><span class="nav-text">景区门票案例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B1%E7%94%A8%E4%BD%93"><span class="nav-text">共用体</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E6%96%B9%E5%BC%8F-1"><span class="nav-text">定义方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%A0%E7%94%A8%E7%A9%BA%E9%97%B4%E7%BB%86%E8%8A%82%E6%B3%A8%E6%84%8F"><span class="nav-text">占用空间细节注意</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8%E8%AF%A6%E8%A7%A3"><span class="nav-text">内存占用详解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-text">最佳实践</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6"><span class="nav-text">文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BE%93%E5%85%A5-%E8%BE%93%E5%87%BA"><span class="nav-text">输入&amp;输出</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%87%E5%87%86%E6%96%87%E4%BB%B6"><span class="nav-text">标准文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="nav-text">常用函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#getchar-putchar-%E5%87%BD%E6%95%B0"><span class="nav-text">getchar() &amp; putchar() 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gets-puts-%E5%87%BD%E6%95%B0"><span class="nav-text">gets() &amp; puts() 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#scanf-%E5%92%8C-%E5%92%8C-printf-%E5%87%BD%E6%95%B0"><span class="nav-text">scanf() 和 和 printf() 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99"><span class="nav-text">文件读写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6"><span class="nav-text">打开文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B3%E9%97%AD%E6%96%87%E4%BB%B6"><span class="nav-text">关闭文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6"><span class="nav-text">写入文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="nav-text">读取文件</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1815293530059355"
     crossorigin="anonymous"></script>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2025</span>
  <span class="with-love" id="heart">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">木鲸鱼</span>
  
</div>









        
<div class="busuanzi-count">
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user-circle-o"></i> 访问人数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> 访问总量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  








  <script src="//code.bdstatic.com/npm/leancloud-storage@4.12.0/dist/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>

  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: true,
        appId: 'WWd60b61wU67AeJzg0yzDD1E-gzGzoHsz',
        appKey: 'QjMAV3Hw76n6nhrDaxLtfoPE',
        placeholder: '网络一线牵珍惜,珍惜这段缘\n 您可以填写邮箱，回复评论时，您会收到邮件通知。',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
        serverURLs: 'https://wwd60b61.lc-cn-n1-shared.com'
    });
  </script>


  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  

  
  <!-- 代码块复制功能 -->
  <!-- 代码块复制功能 -->
<script type="text/javascript" src="/js/src/clipboard.min.js"></script>  
<script type="text/javascript" src="/js/src/clipboard-use.js"></script>
  
  <!-- 音乐 
  <link rel="stylesheet" href="/dist/APlayer.min.css">
<div id="aplayer"></div>
<script type="text/javascript" src="/dist/APlayer.min.js"></script>
<script type="text/javascript" src="/dist/music.js"></script>
  -->

  <!-- 动态背景 
  <script type="text/javascript" src="/js/src/dynamic_bg.js"></script>
  -->
  
</body>
</html>
